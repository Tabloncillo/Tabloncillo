<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<meta name="theme-color" content="#0B1829">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Tabloncillo">
<meta name="description" content="Baloncesto Cubano â€” Liga de La Habana en tu bolsillo">
<title>Tabloncillo â€” Baloncesto Cubano</title>
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Barlow+Condensed:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
<link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiVGFibG9uY2lsbG8iLCJzaG9ydF9uYW1lIjoiVGFibG9uY2lsbG8iLCJzdGFydF91cmwiOiIuIiwiZGlzcGxheSI6InN0YW5kYWxvbmUiLCJiYWNrZ3JvdW5kX2NvbG9yIjoiIzBCMTgyOSIsInRoZW1lX2NvbG9yIjoiIzBCMTgyOSIsImljb25zIjpbXX0=">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{background:#0B1829;color:#E8DFD0;font-family:'Barlow Condensed',-apple-system,sans-serif;-webkit-tap-highlight-color:transparent;overflow-x:hidden}
::-webkit-scrollbar{width:3px}::-webkit-scrollbar-thumb{background:#1A3352;border-radius:3px}
input::placeholder{color:#3A5068}select{appearance:none}option{background:#0F1F35;color:#E8DFD0}
button{font-family:'Barlow Condensed',-apple-system,sans-serif}
.osw{font-family:'Oswald','Barlow Condensed',sans-serif;text-transform:uppercase;letter-spacing:3px}
@keyframes fadeIn{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:none}}.fi{animation:fadeIn .2s ease}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.3}}.pulse{animation:pulse 1.2s infinite}
</style>
<!-- GoatCounter Analytics â€” Change "tabloncillo" to your GoatCounter subdomain -->
<!-- Sign up free: https://goatcounter.com -->
<script data-goatcounter="https://tabloncillo.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
</head>
<body>
<!-- Loading Screen -->
<div id="loader" style="position:fixed;inset:0;background:#0B1829;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999;transition:opacity .4s">
  <img id="loader-img" style="width:100px;height:100px;filter:invert(.92) brightness(1.1) sepia(.08);animation:loaderPulse 1.5s ease infinite" alt="">
  <div style="font-family:'Oswald',sans-serif;font-size:28px;font-weight:700;letter-spacing:6px;color:#E8DFD0;margin-top:16px;text-transform:uppercase">TABLONCILLO</div>
  <div style="font-family:'Oswald',sans-serif;font-size:11px;letter-spacing:4px;color:#C9A84C;margin-top:4px">BALONCESTO CUBANO</div>
  <div style="width:40px;height:2px;background:#CE1126;margin-top:16px;animation:loaderBar 1.2s ease infinite"></div>
</div>
<style>
@keyframes loaderPulse{0%,100%{transform:scale(1);opacity:.9}50%{transform:scale(1.05);opacity:1}}
@keyframes loaderBar{0%{width:40px;opacity:.3}50%{width:80px;opacity:1}100%{width:40px;opacity:.3}}
</style>
<div id="app"></div>
<script>
const AC="#CE1126",GD="#C9A84C",GN="#2ECC71",BG="#0B1829",SF="#0F1F35",BD="#1A3352";
// Cuban star â€” the lone star from the flag
function cubanStar(sz,c){return h("div",{innerHTML:`<svg width="${sz}" height="${sz}" viewBox="0 0 24 24" fill="${c||AC}"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01z"/></svg>`,style:{display:"inline-flex",lineHeight:"0"}})}
// Social links
const SOCIAL={ig:"https://instagram.com/tabloncillo",fb:"https://facebook.com/tabloncillo",tt:"https://tiktok.com/@tabloncillo",yt:"",wa:""};
// Logo data
const LOGO_IMG="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAAAAAAD/4gHYSUNDX1BST0ZJTEUAAQEAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADb/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCAB4AHgDASIAAhEBAxEB/8QAHAAAAwEAAwEBAAAAAAAAAAAAAAECBwQFCAMG/8QAPxAAAQIDBQUFBwIEBQUAAAAAAQIRAAMSBAUTIWEGIjEyUSNBQlNiBxQzQ3FygVLRCBU0oRaCkaPBRGSEosL/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8A2zs8MAE+7vunvr/aHvVrdsYjth3BOkNlYhBpxm3v0U6axIpoQRVhk9m/MT6tIBhml08o/p9T3vCNNMwKPZk9ueitIZ+Y/EfFbg3pgD1IAaojsn4N6tYBkzHRUAJg+AO4jX8Q6lLebIYqVlMfoOkfMUULpKqB8R+P+WLKcU0k0rl5qpyBGkBIooSEE4IPZHvK9dIdKBMCnPvZPDw1Q60qWqaARLmChIbMK+ndCACZRl5mgNNPf/lMAjRQqsnBKu1PeF9BpFEzcVJWB7y3ZgcKdf7wgFVpCacSl0Py066x1/8AO7mFvN3C9LL7y7KsyrQnHfoEu/4gOeW7Svv/AKhu7o0UCutJDYoS0sdxR1OsIfLbv+E//wBQt2lT1UBTLbmq00gF2WCQCfdHzV31RbzMRJLe8AdkO4p1g38Vt3HbIeBv3iQUYaiK8IHffmf06QB2eGoEn3d9899cEUysRIFOK27+mnXWCAjs8IM/u9W71r/aK3q1u2K3bdKdIbqrJKk4jMVjlI6DWJDUpABCAdxJ5kHqrSAAzS6eX/p/rrAaaJjvhv2/WrSGXNT5k/EI+Z9sAd0kEBQHZqPBA6K1gGa6pbtiN2PRtfxEHDoTU+E/ZNxq73/MNk0rASoJPOk8V/bFCqpRCkhZG8o8qh0GsAHExFVNjU9o3CjTWJHCXT/4793V4AEhKQEqCAd1J5knqdIZzC3zf4jfM+2A66/ja07NXqq7gr3oWaaZQHHHpNLflo8Uqmz02ozlTJgtAXUVkmoKd3fi7x7nFVQIUkLAZKjwSOh1jH/bhcez1j2Nm3oi67NIvO0WuWhE9KAiapRqKipuIIB/tAaFsXek++tiLqvK1hWNaLIhVqJ4rLNUPqz/AJjvhXWlmxaez6Ua6xw7psku77mu+yWdIlyrPZ5cuSnygEgb0cvKlQKVFBLqSOKj1GkAuywC1Xuj5jxVRfaYiHbHbsulOsDqxKq04rZTPAB0+sSKaVClWGTvIPMo9RpAG5hq44FW+O+rTSCKSoJSyUKEp85Z5ieo0ggJbw4bd+C/L6ngcHOt6ssTzfTpA6aAalYbsF+InodIedSwUgLA30+FA6p1gFwyamnu8jXWDqKXqzo87XSAZhDZg/DJ+Z90DhlkkgA9oocZZ6J0gB8nxKqfH5P79IGHDDrb5b/D1/PGHvOgFKQo8iRwX90IlISklSkoJ3VDio9DpADg72JU+WJ5npjq9oNobs2Xuld5XraPd7PLIQlhUqWo8EpA5iW/tHamoKUClIWBvJHKkdRrGRe3C1bP3hsymwz79s8i87HNxpFmDrXOJSQUrCXKCxyJb+8B+32T28uDbWRNN0zlGdKPaWKeAiaR+tnOWoeMx9sVul7S7c7O7J2G0C0zJc4e8hAela1JAB+1AJ0eMn2P2ln7IXwb5si3tUqWpEuSpJomVBjUQeAyLd5AjUvYhs9bL0v+27bXoFKBUtFnmKHxZ6zvq+gBIf1aQG85NkKkq4Dzv2aBwM62bLE8v0wcK3yA+I3y/thiqsAJSVEOlJ4KHU6wCbw4Wvu78fU8NxzYjtljeXpEunCKq1YL5zfGD0+kXvVpBQkTCN1HhUOp1gFU+9jVAZY7cvpaCGQvFAKECa2UschHU6wQA6qyak4jMV+EjoNYkAUpABCAdxJ5kHqrSBhy4bNngvy+p4HHGp6ssTzfTpAP9b5k/EI8f2wZuliAoDcUeEsdFawshly093ka6wZcKXqzo87XSAAE0qASoJPODxmfbFCoKUQpIWRvrPBQ6CJcccSpvH5MdLtXtJYtktm7Xe1sSlQkJaVZyWJmHlSOrnPQOYDp/aB7QLBsPc1SMObeUz+ksSl7wPmLHEIH9zl1by7fl2XzZvdr0viTNQq9UqtUuZN5poKi6iNTn9CDG0bBeze8r/vz/Gu24Exc9eNJsc5Lmao8K0nlSBwT9HYZHjfxFzbOf8PSBMAtCMdWCGeWg0AP+RAYSI9l7B3cm6dg7ksaAEqTYZapimyUVisgauox49u6xTLyvOy2GV8S0zkSU/VRA/5j2/JkIs0iXZ0IZElAQmX5YAYK/tAfQZBDZBPw3+X90JhSoFKigl1JHFR6jSDIj9VX+/8AtA441s2WJ5fpgK3sSqtGKzCZ4AOn1iWSJSzQsSn30nmUeo0gAHLhN/2/X1PFlSlFJKTkGEr9Y66QHzFGGQlCxKfOWecnqNIIp/HiM2WM3J6YIBOmgGpRluwX4ieh0h51LBACwN9I5UDqnWDexCqpOKzGZ4SOg1hAClIAIQC6Enig9VaQADkhswfhk/M+6DJllzSDvqHFB6Jgz33Lk/EI+Z9sdJtbc9437s5Pu2670/l1onAIFoCScOX4kkguCRk8BF+bbbN7NS0rve9bLIUSyJUsmYqZ1qSlz/rH5Ob7PZ201/WLaC+9oZ1vsiJ0q02GWlLS8OoqoCWDZUCo5nPSM7vj2A7QWSWld1W6zXkXIUhScBXA5iokKHdx7xHebK+2abs6Jez2112TrNPsYTZl2mWjeCUhgFyz0A4p49IDbrVakWOz2i1WopQmRLVNntyoQA5UNWjxXtDfVo2h2gt162qYtcy0zVLFZchL7qfoAw/EbX7a9tlr2Xuq77lmpVdV7oVO96lzM5iUljL6s5BL/TrGAwGhexW7f5j7TrAoy5cxNkRMtJSssHSlgdSFKBj1SGoBClFBLJUeZR6HSPO/8Pd2ItG0l7XkupXulkTKCE8SZiuP4CD/AKx6J3ipRqSVkMpQ5VDoNYBdy3yKfiN8v7YYcqSAlNZDpSeVQ6nWEOCKd0p+GD8v7oGFKgUqKSXUgcyldRpAJ0mUVVrwnzmeMHp9IFELUJpUoS5e6ojiPpFOvEqrRitlN8AHT6wzViA1JxANxfhSOh1gDexAAlOIQ6UeEjqdYIlk0EUqwyXUjxKPUaQQAw5cNmzwX5fU8Gtb1ZYnm+nSB00PUoy3YL8RPQ6Q86lAgBYDrSOVA6p1gFkPTT3eRrrAw4UvV4PO10gHBDZhXwyfmfdBkyySQkHfUOMs9E6QAVDiZrtlX5On/EZZ7ZtntmrfdVmtt5WuXdl6qWLPZJxSSD30zG8HfV4X7+EaoAqsAISZhG6g8qh1OsYR7TbNevtE9oUrZW55SMG6JVU60TnCUqmBJJUWduVIAD8YDMbNsRtXeF9SLiTdlrM6qlFaThISS5WF8tHfUMj3PHY+0f2fjYK1XdJTeAtnvclSldnSULSQCOJyzy74/dT/AGHbV2a7EybDtUhc5EsGZZFLmy5acswlQJBH4EfhLT7K9uZVpTZ1XNaJyaqUzZa0zJYfvKgch9WgNV/h9uuZZtlbzvNaVSRa7UlEucRxShPd+VEfiNfAHCikjPD8v1RwLhuiVcNxXfdFmQmmyyEy0J8K2GajqS5/Mc8NSCFKKSWSo8yj0OkAZH1Vf7/7Qa1s2WJ5fpgPjfIp+I3y/thiqpICUlZDpSeVQ6nWATeDC193fj6ngID04fH5PmawnThlVa8J85vjB6fSLNEoFE1awpe8lQzIGnSAl86sRmyxm5PTBFMrECaU4hDpR4VDqdYIBb1ZJWnEZjM8JHQawgBSkMQgHcQeKD1VpA3hw+GeA/L6ng1rd8sTzfTAGe+5cn4hHzPthh3SQQFAdmo8EDorWF+Kae7yNdYG7qXq8Hna6QCZNCgUqMsneQOZR6jSPnKsciRbLRapMmzy7XaKca0JQBiABgFHvIGQePq/ixGbLG8v0wNlTha4D/8As8AAClICVBALpSeZKup0ilVlSStctaxyLRyp+6Jd88Sp8sXzPTBSE5YGE/y3+LpAIgUKBSooJdSRzKV1GkVvVqJUkrIZSxyqT0GsJ++tmyxf0eiADuw6WzwvL9UABwEU5U/Df5f3QMKVApUUEupI4qV1GkLj6qv9/wDaGOtbNlieX6IBuvEqrTjNlN8AHT6xICQhSQlVB5keJR6jSG3gwtfd34+p4H78V2+c3w9IBirECqk4gDJX4UjodYITeHDd88F+f1QQA6aAalYbsJniJ6HSHvVKBSAsB1oHKgdU6wQQCGYQ2YV8MnjM+6B2SskkJSe0I4oPROkEEAwFVpSEpMwh0oPKodTrEunDqrVhu2J4n6fSCCAohQUpJSkLAdSRypT1GsSCgoUUTJi0Ab6lcyftgggKAVUkBKSsh0pPKpPU6xIIKQQpRQSyVHmUeh0gggGcq3yp+I3y/thgKqSAkFZDpSeVSep1gggJBThFVa8F2M3xg9PpFMutKShImEbiByqHU6wQQApYUkqJIlgspY5knoNIIIID/9k=";
const LOGO_SM="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAAAAAAD/4gHYSUNDX1BST0ZJTEUAAQEAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADb/2wBDAA0JCgsKCA0LCgsODg0PEyAVExISEyccHhcgLikxMC4pLSwzOko+MzZGNywtQFdBRkxOUlNSMj5aYVpQYEpRUk//2wBDAQ4ODhMREyYVFSZPNS01T09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0//wAARCAAgACADASIAAhEBAxEB/8QAGgAAAgMBAQAAAAAAAAAAAAAAAAYCBAUDB//EACcQAAIBBAEDBAIDAAAAAAAAAAECAwAEBREhBhIiEzFBcQcUobHh/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhEDEQA/APQ6KKq5G/ix9t60oZ2J7Y4kG3lc+yqPkn/aDjNkZYs7b442UhhniZxcg+IZee3X1/daFJvQ2Sv+oJJchkJAy2ReGLxAJLkEk644UAD7NOVAUldR5HJ41ZEuYYZ8hdRtHYz27lViB0G8WO1YDnu+eBxTrVW5xtjeSGS7s4J2KenuVA/jvehv25oMD8b2v6/SEDle1riR5Tsckb0P4WmmoQxRwQpDBGscUahURRoKB7ACp0H/2Q==";
document.getElementById("loader-img").src=LOGO_IMG;
// Custom SVG nav icons
const IC={
  juegos:`<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="CCC" stroke-width="2"><rect x="2" y="3" width="20" height="18" rx="2"/><line x1="12" y1="3" x2="12" y2="21"/><line x1="2" y1="12" x2="22" y2="12"/><circle cx="12" cy="12" r="3"/></svg>`,
  tabla:`<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="CCC" stroke-width="2"><rect x="3" y="14" width="4" height="7"/><rect x="10" y="8" width="4" height="13"/><rect x="17" y="3" width="4" height="18"/></svg>`,
  mvp:`<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="CCC" stroke-width="2"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01z"/></svg>`,
  playoffs:`<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="CCC" stroke-width="2"><path d="M6 9H2V4h4M18 9h4V4h-4M6 9v3h12V9M12 12v3"/><path d="M8 15h8v5H8z"/></svg>`,
  cal:`<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="CCC" stroke-width="2"><rect x="3" y="4" width="18" height="17" rx="2"/><line x1="3" y1="10" x2="21" y2="10"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="16" y1="2" x2="16" y2="6"/></svg>`,
  admin:`<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="CCC" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg>`,
  live:`<svg width="20" height="20" viewBox="0 0 24 24" fill="#CE1126" stroke="none"><circle cx="12" cy="12" r="5"/><circle cx="12" cy="12" r="9" fill="none" stroke="#CE1126" stroke-width="1.5" opacity=".4"/></svg>`
};
function navIcon(key,active){return h("div",{innerHTML:IC[key].replace(/CCC/g,active?"#E8DFD0":"#2E4560"),style:{display:"flex",alignItems:"center",justifyContent:"center",width:"20px",height:"20px"}})}
const T=[
{id:"PLY",name:"Tiburones",zone:"Playa",c:"#0077B6",a:"#90E0EF",roster:[{nm:"C. HernÃ¡ndez",num:"7",pos:"G"},{nm:"Y. PÃ©rez",num:"11",pos:"F"},{nm:"L. RodrÃ­guez",num:"4",pos:"G"},{nm:"R. GarcÃ­a",num:"23",pos:"C"},{nm:"D. Soto",num:"15",pos:"F"}]},
{id:"CRO",name:"Cimarrones",zone:"Cerro",c:"#B5151D",a:"#FFD166",roster:[{nm:"M. DÃ­az",num:"10",pos:"G"},{nm:"A. Reyes",num:"33",pos:"C"},{nm:"E. ValdÃ©s",num:"5",pos:"G"},{nm:"J. MartÃ­nez",num:"8",pos:"F"},{nm:"R. Ãlvarez",num:"21",pos:"F"}]},
{id:"D10",name:"Huracanes",zone:"10 de Octubre",c:"#FF6B00",a:"#FFF",roster:[{nm:"Y. DurÃ¡n",num:"3",pos:"G"},{nm:"P. Castillo",num:"14",pos:"F"},{nm:"M. Herrera",num:"9",pos:"C"},{nm:"F. DomÃ­nguez",num:"22",pos:"F"},{nm:"Y. MartÃ­nez",num:"6",pos:"G"}]},
{id:"CTH",name:"Gladiadores",zone:"Centro Habana",c:"#6A0572",a:"#F49FBC",roster:[{nm:"A. Borroto",num:"2",pos:"G"},{nm:"Y. Leal",num:"14",pos:"F"},{nm:"D. Puig",num:"8",pos:"C"},{nm:"P. Noa",num:"11",pos:"G"},{nm:"F. Cuesta",num:"25",pos:"F"}]},
{id:"HVJ",name:"Corsarios",zone:"Habana Vieja",c:"#1B4332",a:"#D4A373",roster:[]},
{id:"MRN",name:"Alacranes",zone:"Marianao",c:"#023E8A",a:"#48CAE4",roster:[{nm:"R. Vega",num:"1",pos:"G"},{nm:"D. LÃ³pez",num:"12",pos:"F"},{nm:"O. Ruiz",num:"30",pos:"C"},{nm:"L. ConcepciÃ³n",num:"7",pos:"G"},{nm:"Y. PÃ¡ez",num:"20",pos:"F"}]},
{id:"LIS",name:"Panteras",zone:"La Lisa",c:"#212529",a:"#F8F9FA",roster:[]},
{id:"REG",name:"Mambises",zone:"Regla",c:"#9B2226",a:"#EE9B00",roster:[{nm:"O. Torres",num:"6",pos:"G"},{nm:"Y. CÃ¡rdenas",num:"13",pos:"C"},{nm:"L. Mena",num:"9",pos:"F"},{nm:"R. Blanco",num:"17",pos:"G"},{nm:"A. PÃ©rez",num:"24",pos:"F"}]},
{id:"GBK",name:"Gallos",zone:"Guanabacoa",c:"#2D6A4F",a:"#95D5B2",roster:[]},{id:"BOY",name:"Ãguilas",zone:"Boyeros",c:"#3C096C",a:"#E0AAFF",roster:[]},
{id:"ARN",name:"Caribes",zone:"A. Naranjo",c:"#774936",a:"#FFB703",roster:[]},{id:"COT",name:"Caimanes",zone:"Cotorro",c:"#006D77",a:"#83C5BE",roster:[]},
{id:"SMP",name:"Dragones",zone:"San Miguel",c:"#D62828",a:"#F77F00",roster:[]},{id:"PLZ",name:"Capitales",zone:"Plaza",c:"#1D3557",a:"#A8DADC",roster:[]},
];
const gt=id=>T.find(t=>t.id===id)||T[0];
const DB={set(k,v){localStorage.setItem(k,JSON.stringify(v))},get(k){try{return JSON.parse(localStorage.getItem(k))}catch{return null}},del(k){localStorage.removeItem(k)},
  all(p){const r=[];for(let i=0;i<localStorage.length;i++){const k=localStorage.key(i);if(k.startsWith(p))try{r.push(JSON.parse(localStorage.getItem(k)))}catch{}}return r}};

let S={view:"hero",tab:"scores",games:[],sched:[],admin:false,reporter:false,exp:null,tp:null,pp:null,user:DB.get("my_profile"),court:null,liveGame:null,allstar:DB.get("allstar_votes"),wallpaper:null,editTeam:null,adminTab:"report"};
const ADMIN_PIN="1976",REP_PIN="2026";

function h(t,a,...c){const e=document.createElement(t);if(a)Object.entries(a).forEach(([k,v])=>{if(k==="style"&&typeof v==="object")Object.assign(e.style,v);else if(k.startsWith("on"))e.addEventListener(k.slice(2).toLowerCase(),v);else if(k==="innerHTML")e.innerHTML=v;else e.setAttribute(k,v)});c.flat(9).forEach(x=>{if(x!=null&&x!==false)e.appendChild(typeof x==="string"||typeof x==="number"?document.createTextNode(String(x)):x)});return e}
function bd(id,sz){const t=gt(id);const logo=DB.get("logo_"+id);
  if(logo)return h("img",{src:logo,style:{width:sz+"px",height:sz+"px",borderRadius:(sz*.3)+"px",objectFit:"cover",flexShrink:"0",minWidth:sz+"px"}});
  return h("div",{style:{width:sz+"px",height:sz+"px",borderRadius:(sz*.3)+"px",background:`linear-gradient(135deg,${t.c},${t.c}cc)`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:Math.max(sz*.28,8)+"px",fontWeight:"900",color:t.a,letterSpacing:"0.5px",flexShrink:"0",minWidth:sz+"px"}},id)}
function playerPic(nm,tm,sz){const key="pic_"+nm.replace(/\s/g,"_")+"_"+tm;const pic=DB.get(key);
  if(pic)return h("img",{src:pic,style:{width:sz+"px",height:sz+"px",borderRadius:"50%",objectFit:"cover",flexShrink:"0"}});
  const t=gt(tm);return h("div",{style:{width:sz+"px",height:sz+"px",borderRadius:"50%",background:t.c+"44",display:"flex",alignItems:"center",justifyContent:"center",fontSize:Math.max(sz*.35,8)+"px",fontWeight:"900",color:t.a,flexShrink:"0"}},(nm[0]||"?"))}
const CD=`background:${SF};border:1px solid ${BD};border-radius:4px;overflow:hidden`;
const IS=`background:#0B1829;border:1px solid ${BD};border-radius:8px;padding:8px 10px;color:#E8DFD0;font-size:12px;font-weight:600;outline:none;width:100%`;

function init(){
  T.forEach(t=>{const saved=DB.get("team_"+t.id);if(saved){if(saved.name)t.name=saved.name;if(saved.zone)t.zone=saved.zone;if(saved.roster)t.roster=saved.roster}});
  S.games=DB.all("game_").sort((a,b)=>(b.createdAt||0)-(a.createdAt||0));S.sched=DB.all("sched_");if(!S.games.length)seed();
  // Track visits locally
  const today=new Date().toISOString().split("T")[0];
  const visits=DB.get("analytics")||{total:0,daily:{},first:today,sessions:[]};
  visits.total++;visits.daily[today]=(visits.daily[today]||0)+1;
  if(!visits.sessions.includes(today))visits.sessions.push(today);
  visits.last=today;DB.set("analytics",visits);
  render();
  setTimeout(()=>{const ld=document.getElementById("loader");if(ld){ld.style.opacity="0";setTimeout(()=>ld.remove(),400)}},600)
}

function seed(){
  const mk=(nm,num,tm,min,pts,reb,ast,stl,blk,fgm,fga)=>({nm,num,tm,min,pts,reb,ast,stl,blk,fgm,fga});
  const gs=[
    {id:"game_s1",home:"CRO",away:"PLY",hs:78,as:85,dt:"2026-02-21",loc:"Sala RamÃ³n Fonst",desc:"HernÃ¡ndez 24pts liderÃ³ a Tiburones.",createdAt:Date.now(),qs:[[22,20],[18,25],[20,18],[18,22]],ps:[mk("C. HernÃ¡ndez","7","PLY",32,24,5,7,3,0,9,16),mk("Y. PÃ©rez","11","PLY",28,18,8,2,1,2,7,13),mk("L. RodrÃ­guez","4","PLY",30,15,3,4,2,0,6,12),mk("R. GarcÃ­a","23","PLY",26,12,6,1,0,1,5,10),mk("D. Soto","15","PLY",22,16,2,3,1,0,6,11),mk("M. DÃ­az","10","CRO",34,22,4,8,2,0,8,17),mk("A. Reyes","33","CRO",30,19,10,1,0,3,8,15),mk("E. ValdÃ©s","5","CRO",28,14,3,5,3,0,5,12),mk("J. MartÃ­nez","8","CRO",24,13,5,2,1,1,5,11),mk("R. Ãlvarez","21","CRO",20,10,2,3,0,0,4,9)]},
    {id:"game_s2",home:"D10",away:"MRN",hs:92,as:88,dt:"2026-02-20",loc:"Ciudad Deportiva",desc:"DurÃ¡n explotÃ³ con 28pts.",createdAt:Date.now()-86400000,qs:[[24,22],[22,26],[25,18],[21,22]],ps:[mk("Y. DurÃ¡n","3","D10",36,28,7,5,1,1,11,20),mk("P. Castillo","14","D10",30,20,4,6,2,0,8,15),mk("M. Herrera","9","D10",28,16,8,2,0,2,7,13),mk("F. DomÃ­nguez","22","D10",24,14,3,3,1,0,5,11),mk("Y. MartÃ­nez","6","D10",22,14,5,1,0,1,6,10),mk("R. Vega","1","MRN",34,26,3,9,4,0,10,19),mk("D. LÃ³pez","12","MRN",30,22,6,2,1,1,9,16),mk("O. Ruiz","30","MRN",26,18,9,1,0,3,7,14),mk("L. ConcepciÃ³n","7","MRN",24,12,2,4,2,0,4,10),mk("Y. PÃ¡ez","20","MRN",20,10,4,2,0,0,4,9)]},
    {id:"game_s3",home:"REG",away:"CTH",hs:76,as:81,dt:"2026-02-19",loc:"Regla",desc:"Gladiadores dominaron el 3er cuarto.",createdAt:Date.now()-172800000,qs:[[18,22],[20,19],[16,22],[22,18]],ps:[mk("A. Borroto","2","CTH",34,23,4,6,2,0,9,18),mk("Y. Leal","14","CTH",30,19,7,3,1,1,7,14),mk("D. Puig","8","CTH",28,17,3,5,0,0,6,12),mk("P. Noa","11","CTH",24,12,5,2,1,2,5,10),mk("F. Cuesta","25","CTH",20,10,2,1,0,0,4,9),mk("O. Torres","6","REG",32,21,6,4,1,1,8,16),mk("Y. CÃ¡rdenas","13","REG",28,18,8,2,0,2,7,14),mk("L. Mena","9","REG",26,15,4,3,2,0,6,13),mk("R. Blanco","17","REG",22,12,3,5,1,0,5,11),mk("A. PÃ©rez","24","REG",20,10,5,1,0,1,4,10)]}];
  gs.forEach(g=>DB.set(g.id,g));S.games=gs;
  const sc=[{id:"sched_s1",home:"PLY",away:"D10",dt:"2026-02-23",time:"4:00 PM",loc:"Sala RamÃ³n Fonst",st:"sched"},{id:"sched_s2",home:"CTH",away:"REG",dt:"2026-02-23",time:"6:00 PM",loc:"Ciudad Deportiva",st:"sched"},{id:"sched_s3",home:"GBK",away:"ARN",dt:"2026-02-24",time:"5:00 PM",loc:"Guanabacoa",st:"sched"}];
  sc.forEach(s=>DB.set(s.id,s));S.sched=sc;
}

// Social icon SVGs
function socialBtn(type,url){if(!url)return null;
  const icons={ig:`<svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>`,
    fb:`<svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385h-3.047v-3.47h3.047v-2.642c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953h-1.514c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385c5.738-.9 10.126-5.864 10.126-11.854z"/></svg>`,
    tt:`<svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M12.525.02c1.31-.02 2.61-.01 3.91-.02.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.05-2.89-.35-4.2-.97-.57-.26-1.1-.59-1.62-.93-.01 2.92.01 5.84-.02 8.75-.08 1.4-.54 2.79-1.35 3.94-1.31 1.92-3.58 3.17-5.91 3.21-1.43.08-2.86-.31-4.08-1.03-2.02-1.19-3.44-3.37-3.65-5.71-.02-.5-.03-1-.01-1.49.18-1.9 1.12-3.72 2.58-4.96 1.66-1.44 3.98-2.13 6.15-1.72.02 1.48-.04 2.96-.04 4.44-.99-.32-2.15-.23-3.02.37-.63.41-1.11 1.04-1.36 1.75-.21.51-.15 1.07-.14 1.61.24 1.64 1.82 3.02 3.5 2.87 1.12-.01 2.19-.66 2.77-1.61.19-.33.4-.67.41-1.06.1-1.79.06-3.57.07-5.36.01-4.03-.01-8.05.02-12.07z"/></svg>`,
    yt:`<svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814z"/><path fill="#0B1829" d="M9.545 15.568V8.432L15.818 12z"/></svg>`,
    wa:`<svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z"/><path d="M12 0C5.373 0 0 5.373 0 12c0 2.625.846 5.059 2.284 7.034L.789 23.492l4.634-1.215A11.95 11.95 0 0 0 12 24c6.627 0 12-5.373 12-12S18.627 0 12 0zm0 21.75c-2.09 0-4.028-.656-5.624-1.775l-.404-.24-4.178 1.096 1.114-4.073-.264-.42A9.72 9.72 0 0 1 2.25 12c0-5.385 4.365-9.75 9.75-9.75S21.75 6.615 21.75 12s-4.365 9.75-9.75 9.75z"/></svg>`};
  const colors={ig:"#E4405F",fb:"#1877F2",tt:"#000",yt:"#FF0000",wa:"#25D366"};
  return h("a",{href:url,target:"_blank",rel:"noopener",style:{width:"36px",height:"36px",borderRadius:"4px",background:colors[type]+"22",border:"1px solid "+colors[type]+"44",display:"flex",alignItems:"center",justifyContent:"center",color:colors[type],textDecoration:"none",cursor:"pointer"},innerHTML:icons[type]||""})
}

// â”€â”€â”€ HERO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rHero(){
  const uc=DB.all("user_").length;
  const now=new Date().toISOString().split("T")[0];
  const upcoming=S.sched.filter(s=>s.dt>=now).sort((a,b)=>a.dt.localeCompare(b.dt));
  const lastGame=S.games[0];const match=upcoming[0]||null;
  function getStarPlayer(tid){let best=null;const stats={};
    S.games.forEach(g=>{g.ps?.forEach(p=>{if(p.tm===tid){const k=p.nm;if(!stats[k])stats[k]={nm:p.nm,num:p.num,pts:0,gp:0};stats[k].pts+=p.pts;stats[k].gp++}})});
    Object.values(stats).forEach(p=>{if(!best||p.pts/p.gp>best.pts/best.gp)best=p});
    if(!best){const t=gt(tid);if(t.roster?.length)best={nm:t.roster[0].nm,num:t.roster[0].num,pts:0,gp:0}}return best}
  const els=[];
  // â”€â”€ HEADER with basketball silhouette â”€â”€
  const hero=h("div",{style:{background:"linear-gradient(180deg,"+AC+"18,#0B1829 70%)",padding:"24px 16px 20px",position:"relative",overflow:"hidden"}});
  // Silhouette watermark
  hero.appendChild(h("img",{src:LOGO_IMG,style:{position:"absolute",top:"-10px",right:"-10px",width:"140px",height:"140px",opacity:".06",filter:"invert(.92) brightness(1.1)"}}));
  // Red top bar
  hero.appendChild(h("div",{style:{position:"absolute",top:"0",left:"0",right:"0",height:"4px",background:AC}}));
  hero.appendChild(h("div",{style:{position:"relative",zIndex:"1",display:"flex",alignItems:"center",gap:"14px"}},
    h("img",{src:LOGO_IMG,style:{width:"52px",height:"52px",filter:"invert(.92) brightness(1.1) sepia(.08)"}}),
    h("div",null,
      h("div",{style:{fontSize:"36px",fontWeight:"700",color:"#E8DFD0",lineHeight:"1",fontFamily:"'Oswald',sans-serif",textTransform:"uppercase",letterSpacing:"4px"}},"TABLONCILLO"),
      h("div",{style:{fontSize:"12px",letterSpacing:"5px",color:GD,fontWeight:"600",marginTop:"2px",fontFamily:"'Oswald',sans-serif",textTransform:"uppercase"}},"BALONCESTO CUBANO"),
      h("div",{style:{fontSize:"10px",color:"#5A7A96",marginTop:"3px"}},"Liga de La Habana Â· 14 Municipios"))));
  els.push(hero);
  // â”€â”€ FEATURED MATCHUP â”€â”€
  const mAway=match?match.away:(lastGame?lastGame.away:null);
  const mHome=match?match.home:(lastGame?lastGame.home:null);
  if(mAway&&mHome){
    const at=gt(mAway),ht=gt(mHome);const starA=getStarPlayer(mAway),starH=getStarPlayer(mHome);
    const isScheduled=!!match;const isResult=!match&&lastGame;
    const card=h("div",{style:{background:SF,border:"2px solid "+BD,borderRadius:"4px",overflow:"hidden",cursor:"pointer"},onClick:()=>{S.view="app";if(isResult){S.exp=lastGame.id;S.tab="scores"}else{S.tab="calendar"}render()}});
    // Red header bar
    card.appendChild(h("div",{style:{background:AC,padding:"6px 14px",display:"flex",justifyContent:"space-between",alignItems:"center"}},
      h("span",{style:{fontSize:"9px",fontWeight:"700",letterSpacing:"2px",color:"#E8DFD0",fontFamily:"'Oswald',sans-serif",textTransform:"uppercase"}},isScheduled?"PRÃ“XIMO JUEGO":"ÃšLTIMO RESULTADO"),
      h("img",{src:LOGO_SM,style:{width:"14px",height:"14px",filter:"invert(.92) brightness(1.1)"}})));
    // Body
    const body=h("div",{style:{padding:"16px",background:"linear-gradient(135deg,"+at.c+"10,transparent 40%,transparent 60%,"+ht.c+"10)"}});
    const row=h("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"8px"}});
    // Away side
    const awaySide=h("div",{style:{flex:"1",textAlign:"center"}});
    awaySide.appendChild(bd(mAway,56));
    awaySide.appendChild(h("div",{style:{fontSize:"14px",fontWeight:"700",color:"#E8DFD0",marginTop:"6px",fontFamily:"'Oswald',sans-serif",textTransform:"uppercase",letterSpacing:"1px"}},at.name));
    if(starA)awaySide.appendChild(h("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"6px",marginTop:"8px",background:"#0B182988",borderRadius:"8px",padding:"6px 8px",border:"1px solid "+BD}},
      playerPic(starA.nm,mAway,30),
      h("div",{style:{textAlign:"left"}},h("div",{style:{fontSize:"10px",fontWeight:"700",color:"#B8C8D8"}},"#"+starA.num+" "+starA.nm.split(" ").pop()),
        h("div",{style:{fontSize:"9px",color:GD,fontWeight:"800"}},starA.gp?((starA.pts/starA.gp).toFixed(1)+" PPJ"):"â˜…"))));
    row.appendChild(awaySide);
    // Center
    if(isResult&&lastGame){row.appendChild(h("div",{style:{textAlign:"center",padding:"0 6px"}},
      h("div",{style:{fontSize:"38px",fontWeight:"700",color:lastGame.as>lastGame.hs?"#E8DFD0":"#3A5068",lineHeight:"1",fontFamily:"'Oswald',sans-serif"}},String(lastGame.as)),
      h("div",{style:{fontSize:"12px",color:BD,fontWeight:"900",margin:"4px 0"}},"â€”"),
      h("div",{style:{fontSize:"38px",fontWeight:"700",color:lastGame.hs>lastGame.as?"#E8DFD0":"#3A5068",lineHeight:"1",fontFamily:"'Oswald',sans-serif"}},String(lastGame.hs))))}
    else{row.appendChild(h("div",{style:{textAlign:"center",padding:"0 8px"}},
      h("div",{style:{fontSize:"24px",fontWeight:"700",color:GD,fontFamily:"'Oswald',sans-serif"}},"VS"),
      match?.dt?h("div",{style:{fontSize:"10px",color:"#5A7A96",marginTop:"4px"}},new Date(match.dt+"T12:00").toLocaleDateString("es",{weekday:"short",month:"short",day:"numeric"})):null,
      match?.time?h("div",{style:{fontSize:"12px",color:AC,fontWeight:"800"}},match.time):null))}
    // Home side
    const homeSide=h("div",{style:{flex:"1",textAlign:"center"}});
    homeSide.appendChild(bd(mHome,56));
    homeSide.appendChild(h("div",{style:{fontSize:"14px",fontWeight:"700",color:"#E8DFD0",marginTop:"6px",fontFamily:"'Oswald',sans-serif",textTransform:"uppercase",letterSpacing:"1px"}},ht.name));
    if(starH)homeSide.appendChild(h("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"6px",marginTop:"8px",background:"#0B182988",borderRadius:"8px",padding:"6px 8px",border:"1px solid "+BD}},
      playerPic(starH.nm,mHome,30),
      h("div",{style:{textAlign:"left"}},h("div",{style:{fontSize:"10px",fontWeight:"700",color:"#B8C8D8"}},"#"+starH.num+" "+starH.nm.split(" ").pop()),
        h("div",{style:{fontSize:"9px",color:GD,fontWeight:"800"}},starH.gp?((starH.pts/starH.gp).toFixed(1)+" PPJ"):"â˜…"))));
    row.appendChild(homeSide);body.appendChild(row);
    const meta=isResult?lastGame.dt+(lastGame.loc?" Â· "+lastGame.loc:""):(match?.dt||"")+(match?.loc?" Â· "+match.loc:"");
    if(meta)body.appendChild(h("div",{style:{textAlign:"center",fontSize:"9px",color:"#3A5068",marginTop:"10px"}},meta));
    card.appendChild(body);els.push(card);
  }
  // â”€â”€ ENTER â”€â”€
  els.push(h("div",{style:{textAlign:"center",padding:"4px 0"}},
    h("button",{style:{background:AC,border:"none",borderRadius:"2px",padding:"14px 44px",color:"#E8DFD0",fontSize:"16px",fontWeight:"700",cursor:"pointer",letterSpacing:"5px",fontFamily:"'Oswald',sans-serif",textTransform:"uppercase",boxShadow:"0 4px 20px "+AC+"33"},onClick:()=>{S.view="app";render()}},"ENTRAR"),
    h("div",{style:{display:"flex",justifyContent:"center",gap:"8px",marginTop:"12px"}},...["ig","fb","tt","yt","wa"].map(k=>socialBtn(k,SOCIAL[k])).filter(Boolean))));
  // â”€â”€ STATS BAR â”€â”€
  els.push(h("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gap:"6px",padding:"0 16px"}},
    ...[[S.games.length,"JUEGOS",AC],["14","EQUIPOS","#1D3557"],[uc||"0","FANS",GD],["â˜…","ALL-STAR",AC]].map(([v,l,c],i)=>
      h("div",{style:{background:SF,border:"1px solid "+BD,borderRadius:"4px",padding:"10px 4px",textAlign:"center",cursor:i===3?"pointer":"default"},onClick:i===3?()=>{S.view="app";S.tab="allstar";render()}:null},
        h("div",{style:{fontSize:"20px",fontWeight:"700",color:c,fontFamily:"'Oswald',sans-serif"}},String(v)),h("div",{style:{fontSize:"7px",color:"#3A5068",letterSpacing:"1px",fontWeight:"700"}},l)))));
  // â”€â”€ RECENT â”€â”€
  if(match&&S.games.length){
    els.push(h("div",{style:{fontSize:"12px",fontWeight:"700",letterSpacing:"2px",color:"#5A7A96",fontFamily:"'Oswald',sans-serif",textTransform:"uppercase",padding:"0 16px"}},"ÃšLTIMOS RESULTADOS"));
    const recentEl=h("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"0 16px"}});
    S.games.slice(0,3).forEach(g=>{const at2=gt(g.away),ht2=gt(g.home);
      recentEl.appendChild(h("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",background:SF,border:"1px solid "+BD,borderRadius:"4px",cursor:"pointer"},onClick:()=>{S.view="app";S.exp=g.id;S.tab="scores";render()}},
        bd(g.away,20),h("span",{style:{fontSize:"10px",color:g.as>g.hs?"#E8DFD0":"#5A7A96",fontWeight:g.as>g.hs?"800":"500",flex:"1"}},at2.name),
        h("span",{style:{fontSize:"14px",fontWeight:"700",color:g.as>g.hs?"#E8DFD0":"#3A5068",fontFamily:"'Oswald',sans-serif"}},String(g.as)),
        h("span",{style:{color:BD,fontSize:"10px"}},"â€”"),
        h("span",{style:{fontSize:"14px",fontWeight:"700",color:g.hs>g.as?"#E8DFD0":"#3A5068",fontFamily:"'Oswald',sans-serif"}},String(g.hs)),
        h("span",{style:{fontSize:"10px",color:g.hs>g.as?"#E8DFD0":"#5A7A96",fontWeight:g.hs>g.as?"800":"500",flex:"1",textAlign:"right"}},ht2.name),bd(g.home,20)))});
    els.push(recentEl)}
  // â”€â”€ TEAMS â”€â”€
  els.push(h("div",{style:{fontSize:"12px",fontWeight:"700",letterSpacing:"2px",color:"#5A7A96",fontFamily:"'Oswald',sans-serif",textTransform:"uppercase",padding:"0 16px"}},"LOS 14 DE LA HABANA"));
  els.push(h("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(85px,1fr))",gap:"6px",padding:"0 16px"}},
    ...T.map(t=>h("div",{style:{background:SF,border:"1px solid "+t.c+"33",borderRadius:"4px",padding:"10px 6px",textAlign:"center",cursor:"pointer"},onClick:()=>{S.view="app";S.tp=t.id;S.tab="team";render()}},
      bd(t.id,32),h("div",{style:{fontSize:"9px",fontWeight:"700",color:"#B8C8D8",marginTop:"4px"}},t.name),h("div",{style:{fontSize:"7px",color:"#3A5068"}},t.zone)))));
  return h("div",{style:{maxWidth:"800px",margin:"0 auto",display:"flex",flexDirection:"column",gap:"12px",paddingBottom:"16px"}},...els);
}

// â”€â”€â”€ SCORES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rScores(){
  const el=h("div",{style:{display:"flex",flexDirection:"column",gap:"8px"}});
  if(S.games.length)el.appendChild(h("div",{style:{fontSize:"12px",fontWeight:"800",letterSpacing:"1px"}},"RESULTADOS"));
  S.games.forEach(g=>{const ht=gt(g.home),at=gt(g.away),hw=g.hs>g.as,aw=g.as>g.hs;
    const card=h("div",{className:"fi",style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",padding:"12px 14px",cursor:"pointer",position:"relative"},onClick:()=>{S.exp=S.exp===g.id?null:g.id;render()}},
      h("div",{style:{position:"absolute",top:"0",left:"0",right:"0",height:"3px",background:`linear-gradient(90deg,${at.c},${AC},${ht.c})`}}));
    const row=h("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}});
    const tms=h("div",{style:{flex:"1"}});
    [{tid:g.away,sc:g.as,w:aw,t:at},{tid:g.home,sc:g.hs,w:hw,t:ht}].forEach((x,i)=>{
      tms.appendChild(h("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:i===0?"5px":"0"}},
        bd(x.tid,22),h("span",{style:{fontSize:"13px",fontWeight:x.w?"800":"500",color:x.w?"#fff":"#999",flex:"1",cursor:"pointer"},onClick:e=>{e.stopPropagation();S.tp=x.tid;S.tab="team";render()}},x.t.name),
        h("span",{style:{fontSize:"18px",fontWeight:"900",color:x.w?"#fff":"#555",width:"32px",textAlign:"right"}},String(x.sc))))});
    row.appendChild(tms);row.appendChild(h("div",{style:{textAlign:"right",marginLeft:"12px"}},h("div",{style:{fontSize:"9px",fontWeight:"700",color:GN}},"FINAL"),h("div",{style:{fontSize:"8px",color:"#2E4560",marginTop:"2px"}},g.dt)));card.appendChild(row);
    if(g.qs){const qd=h("div",{style:{display:"flex",gap:"8px",marginTop:"6px",paddingTop:"6px",borderTop:"1px solid #1A335230"}});g.qs.forEach((q,i)=>qd.appendChild(h("div",{style:{textAlign:"center"}},h("span",{style:{fontSize:"7px",color:"#2E4560"}},"Q"+(i+1)),h("div",{style:{fontSize:"9px",color:"#4A6480"}},q[0]+"-"+q[1]))));card.appendChild(qd)}
    if(g.desc)card.appendChild(h("div",{style:{marginTop:"6px",paddingTop:"6px",borderTop:"1px solid #1A335230",fontSize:"10px",color:"#999",fontStyle:"italic"}},"ðŸ“ "+g.desc));
    if(g.by)card.appendChild(h("div",{style:{marginTop:"4px",fontSize:"8px",color:"#2E4560"}},"ðŸ“¡ "+g.by));
    el.appendChild(card);
    // Expanded box score
    if(S.exp===g.id){const box=h("div",{className:"fi",style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"0 0 12px 12px",padding:"14px 16px",marginTop:"-1px"}});
      box.appendChild(h("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"}},h("span",{style:{fontSize:"10px",color:"#3A5068"}},"ðŸ“ "+(g.loc||"â€”")+" Â· "+g.dt+(g.by?" Â· ðŸ“¡ "+g.by:"")),
        h("div",{style:{display:"flex",gap:"6px"}},
          h("button",{style:{background:"#25D366",border:"none",borderRadius:"8px",padding:"5px 12px",color:"#E8DFD0",fontSize:"9px",fontWeight:"700",cursor:"pointer"},onClick:e=>{e.stopPropagation();const txt=`ðŸ€ TABLONCILLO\n${at.name} ${g.as} â€” ${g.hs} ${ht.name}\n${g.desc||""}\ntabloncillo.github.io`;try{navigator.share?.({text:txt})}catch{window.open("https://wa.me/?text="+encodeURIComponent(txt))}}},"ðŸ“¤"),
          h("button",{style:{background:"#1A3352aa",border:"1px solid rgba(255,255,255,.15)",borderRadius:"8px",padding:"5px 10px",color:"#E8DFD0",fontSize:"9px",fontWeight:"700",cursor:"pointer"},onClick:e=>{e.stopPropagation();S.wallpaper=g.id;render()}},"ðŸ“¸"),
          (S.admin||S.reporter)?h("button",{style:{background:"rgba(100,255,218,.15)",border:"1px solid rgba(100,255,218,.3)",borderRadius:"8px",padding:"5px 10px",color:"#5BB8A6",fontSize:"9px",fontWeight:"700",cursor:"pointer"},onClick:e=>{e.stopPropagation();const compact=btoa(unescape(encodeURIComponent(JSON.stringify(g))));const shareText="ðŸ€TB|"+compact;try{navigator.clipboard.writeText(shareText).then(()=>alert("âœ… Datos copiados! PÃ©galo en WhatsApp para sincronizar"))}catch{prompt("Copia:",shareText)}}},"ðŸ“¡ DATOS"):null,
          S.admin?h("button",{style:{background:"rgba(255,59,48,.15)",border:"1px solid rgba(255,59,48,.3)",borderRadius:"8px",padding:"5px 10px",color:"#CE1126",fontSize:"9px",fontWeight:"700",cursor:"pointer"},onClick:e=>{e.stopPropagation();if(confirm("Â¿Eliminar?")){DB.del(g.id);S.games=S.games.filter(x=>x.id!==g.id);S.exp=null;render()}}},"ðŸ—‘ï¸"):null)));
      if(g.ps?.length){[g.away,g.home].forEach(tm=>{const t=gt(tm);const ps=g.ps.filter(p=>p.tm===tm).sort((a,b)=>b.pts-a.pts);if(!ps.length)return;
        box.appendChild(h("div",{style:{display:"flex",alignItems:"center",gap:"6px",margin:"10px 0 4px"}},bd(tm,16),h("span",{style:{fontSize:"10px",fontWeight:"800",color:"#E8DFD0"}},t.name),h("span",{style:{marginLeft:"auto",fontSize:"11px",fontWeight:"900",color:AC}},String(ps.reduce((s,p)=>s+p.pts,0)))));
        const tbl=h("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"9px"}});
        const hdr=h("tr");["","PTS","REB","AST","ROB","BLQ","TC%"].forEach((x,i)=>hdr.appendChild(h("th",{style:{padding:"3px 4px",textAlign:i?"center":"left",color:"#3A5068",fontWeight:"700",fontSize:"7px",borderBottom:"1px solid #1A335240"}},x)));tbl.appendChild(hdr);
        ps.forEach(p=>{const fg=p.fga>0?Math.round(p.fgm/p.fga*100):0;tbl.appendChild(h("tr",null,h("td",{style:{padding:"4px",color:"#D0DCE8",fontWeight:"600",whiteSpace:"nowrap"}},h("span",{style:{color:t.a,fontSize:"8px",marginRight:"3px"}},"#"+p.num),p.nm),
          h("td",{style:{textAlign:"center",color:p.pts>=20?AC:"#aaa",fontWeight:"700"}},String(p.pts)),h("td",{style:{textAlign:"center",color:"#C9A84C"}},String(p.reb)),
          h("td",{style:{textAlign:"center",color:"#5BB8A6"}},String(p.ast)),h("td",{style:{textAlign:"center",color:GD}},String(p.stl)),h("td",{style:{textAlign:"center",color:"#D44040"}},String(p.blk)),
          h("td",{style:{textAlign:"center",color:fg>=50?GN:"#888"}},fg+"%")))});
        box.appendChild(h("div",{style:{overflowX:"auto"}},tbl))})}
      el.appendChild(box)}});
  // Upcoming
  const up=S.sched.filter(s=>s.st==="sched");
  if(up.length){el.appendChild(h("div",{style:{fontSize:"12px",fontWeight:"800",letterSpacing:"1px",marginTop:"8px"}},"ðŸ“… PRÃ“XIMOS"));
    up.forEach(s=>{const ht=gt(s.home),at=gt(s.away);el.appendChild(h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",padding:"12px 14px",opacity:"0.7"}},
      h("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},h("div",{style:{flex:"1"}},
        h("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"5px"}},bd(s.away,22),h("span",{style:{fontSize:"13px",color:"#999"}},at.name)),
        h("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},bd(s.home,22),h("span",{style:{fontSize:"13px",color:"#999"}},ht.name))),
        h("div",{style:{textAlign:"right"}},h("div",{style:{fontSize:"11px",fontWeight:"700",color:"#5A7A96"}},s.time||"TBD"),h("div",{style:{fontSize:"8px",color:"#2E4560"}},s.dt),s.loc?h("div",{style:{fontSize:"8px",color:"#253A52"}},s.loc):null))))})}
  return el;
}

// â”€â”€â”€ STANDINGS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rStand(){
  const rec={};T.forEach(t=>{rec[t.id]={w:0,l:0,pf:0,pa:0}});S.games.forEach(g=>{if(!rec[g.home])return;const hw=g.hs>g.as;rec[g.home].w+=hw?1:0;rec[g.home].l+=hw?0:1;rec[g.home].pf+=g.hs;rec[g.home].pa+=g.as;rec[g.away].w+=hw?0:1;rec[g.away].l+=hw?1:0;rec[g.away].pf+=g.as;rec[g.away].pa+=g.hs});
  const sorted=T.map(t=>({...t,...rec[t.id],pct:rec[t.id].w+rec[t.id].l>0?rec[t.id].w/(rec[t.id].w+rec[t.id].l):0})).sort((a,b)=>b.pct-a.pct||b.pf-a.pf);
  const el=h("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}});
  el.appendChild(h("div",{style:{fontSize:"14px",fontWeight:"900",letterSpacing:"2px"}},"ðŸ“Š POSICIONES"));
  sorted.forEach((t,i)=>{const d=t.pf-t.pa;const quali=i<4;
    el.appendChild(h("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px 14px",background:quali?`linear-gradient(135deg,${AC}08,#0F1F35)`:"#0F1F35",border:"1px solid "+(quali?AC+"22":"#1A335240"),borderRadius:"4px",cursor:"pointer"},onClick:()=>{S.tp=t.id;S.tab="team";render()}},
      h("span",{style:{fontSize:"16px",fontWeight:"900",color:quali?GD:"#555",width:"20px",textAlign:"center"}},String(i+1)),
      bd(t.id,36),
      h("div",{style:{flex:"1"}},
        h("div",{style:{fontSize:"13px",fontWeight:"700",color:quali?"#fff":"#aaa"}},t.name),
        h("div",{style:{fontSize:"9px",color:"#3A5068"}},t.zone)),
      h("div",{style:{textAlign:"center",minWidth:"40px"}},
        h("div",{style:{fontSize:"14px",fontWeight:"900"}},h("span",{style:{color:GN}},String(t.w)),h("span",{style:{color:"#253A52"}},"-"),h("span",{style:{color:"#5A7A96"}},String(t.l))),
        h("div",{style:{fontSize:"8px",color:"#3A5068"}},t.pct?t.pct.toFixed(3).slice(1):"â€”")),
      h("span",{style:{fontSize:"10px",fontWeight:"700",color:d>0?GN:d<0?"#D44040":"#555",minWidth:"30px",textAlign:"right"}},(d>0?"+":"")+String(d||"â€”")),
      quali?h("div",{style:{width:"4px",height:"24px",borderRadius:"2px",background:AC}}):null))});
  el.appendChild(h("div",{style:{fontSize:"9px",color:"#3A5068",textAlign:"center",padding:"4px"}},h("span",{style:{color:AC}},"â– ")," Top 4 â†’ Playoffs"));
  // Quick links
  el.appendChild(h("div",{style:{display:"flex",gap:"6px"}},
    h("button",{style:{flex:"1",background:SF,border:"1px solid "+BD,borderRadius:"4px",padding:"10px",color:"#8BA0B4",fontSize:"10px",fontWeight:"700",cursor:"pointer",fontFamily:"'Oswald',sans-serif",letterSpacing:"1px"},
      onClick:()=>{S.tab="mvp";render()}},"ðŸ… MVP"),
    h("button",{style:{flex:"1",background:SF,border:"1px solid "+BD,borderRadius:"4px",padding:"10px",color:"#8BA0B4",fontSize:"10px",fontWeight:"700",cursor:"pointer",fontFamily:"'Oswald',sans-serif",letterSpacing:"1px"},
      onClick:()=>{S.tab="leaders";render()}},"ðŸ“ˆ LÃDERES")));
  return el;
}

// â”€â”€â”€ LEADERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rLeaders(){
  const allP={};S.games.forEach(g=>{g.ps?.forEach(p=>{const k=p.nm+"_"+p.tm;if(!allP[k])allP[k]={nm:p.nm,tm:p.tm,num:p.num,gp:0,pts:0,reb:0,ast:0,stl:0,blk:0};allP[k].gp++;allP[k].pts+=p.pts;allP[k].reb+=p.reb;allP[k].ast+=p.ast;allP[k].stl+=p.stl;allP[k].blk+=p.blk})});
  const all=Object.values(allP);if(!all.length)return h("div",{style:{textAlign:"center",padding:"40px",color:"#3A5068"}},"Se necesitan juegos con stats");
  const el=h("div",{style:{display:"flex",flexDirection:"column",gap:"12px"}});
  el.appendChild(h("div",{style:{fontSize:"14px",fontWeight:"900",letterSpacing:"2px"}},"ðŸ“ˆ LÃDERES"));
  [{k:"pts",l:"ANOTADORES",c:AC,ic:"ðŸ”¥"},{k:"reb",l:"REBOTEADORES",c:"#C9A84C",ic:"ðŸ’ª"},{k:"ast",l:"ASISTENTES",c:"#5BB8A6",ic:"ðŸŽ¯"},{k:"stl",l:"ROBOS",c:GD,ic:"ðŸ‘‹"},{k:"blk",l:"BLOQUEOS",c:"#D44040",ic:"ðŸ–ï¸"}].forEach(cat=>{
    const sorted=[...all].sort((a,b)=>(b[cat.k]/b.gp)-(a[cat.k]/a.gp)).slice(0,5);
    const sec=h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",overflow:"hidden"}});
    sec.appendChild(h("div",{style:{padding:"10px 16px",borderBottom:"1px solid #1A335260",display:"flex",alignItems:"center",gap:"6px"}},h("span",null,cat.ic),h("span",{style:{fontSize:"11px",fontWeight:"800",letterSpacing:"1px"}},cat.l)));
    sorted.forEach((p,i)=>{const t=gt(p.tm);sec.appendChild(h("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 16px",borderBottom:"1px solid #1A335222",cursor:"pointer"},onClick:()=>{S.tp=p.tm;S.tab="team";render()}},
      h("span",{style:{fontSize:"14px",fontWeight:"900",color:i===0?cat.c:"#555",width:"20px"}},String(i+1)),
      playerPic(p.nm,p.tm,28),
      h("div",{style:{flex:"1"},onClick:e=>{e.stopPropagation();S.pp=p.nm+"|||"+p.tm;S.tab="player";render()}},h("div",{style:{fontSize:"12px",color:"#D0DCE8",fontWeight:"600",cursor:"pointer"}},p.nm),h("div",{style:{fontSize:"9px",color:"#3A5068"}},t.name+" Â· "+p.gp+"J")),
      h("span",{style:{fontSize:"18px",fontWeight:"900",color:cat.c}},(p[cat.k]/p.gp).toFixed(1))))});
    el.appendChild(sec)});return el;
}

// â”€â”€â”€ CALENDAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rCalendar(){
  const all=[...S.games.map(g=>({...g,type:"done"})),...S.sched.filter(s=>s.st==="sched").map(s=>({...s,type:"sched"}))].sort((a,b)=>new Date(b.dt)-new Date(a.dt));
  const gr={};all.forEach(i=>{if(!gr[i.dt])gr[i.dt]=[];gr[i.dt].push(i)});
  const el=h("div",{style:{display:"flex",flexDirection:"column",gap:"10px"}});
  el.appendChild(h("div",{style:{fontSize:"14px",fontWeight:"900",letterSpacing:"2px"}},"ðŸ“… CALENDARIO"));
  Object.entries(gr).sort((a,b)=>new Date(b[0])-new Date(a[0])).forEach(([dt,items])=>{
    const dayLabel=new Date(dt+"T12:00:00").toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long"}).toUpperCase();
    el.appendChild(h("div",{style:{fontSize:"10px",fontWeight:"800",color:GD,letterSpacing:"1px",marginTop:"4px"}},dayLabel));
    items.forEach(item=>{const ht=gt(item.home),at=gt(item.away);
      el.appendChild(h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",padding:"10px 12px",marginBottom:"4px"}},
        h("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},
          h("div",{style:{flex:"1"}},
            ...[{id:item.away,t:at,sc:item.as},{id:item.home,t:ht,sc:item.hs}].map((x,j)=>
              h("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:j===0?"4px":"0",cursor:"pointer"},onClick:()=>{S.tp=x.id;S.tab="team";render()}},
                bd(x.id,18),h("span",{style:{fontSize:"11px",fontWeight:item.type==="done"&&((j===0&&item.as>item.hs)||(j===1&&item.hs>item.as))?"700":"500",color:item.type==="done"&&((j===0&&item.as>item.hs)||(j===1&&item.hs>item.as))?"#fff":"#999"}},x.t.name),
                item.type==="done"?h("span",{style:{fontSize:"13px",fontWeight:"900",color:((j===0&&item.as>item.hs)||(j===1&&item.hs>item.as))?"#fff":"#555",marginLeft:"auto"}},String(x.sc)):null))),
          h("div",{style:{textAlign:"right",marginLeft:"12px"}},
            item.type==="sched"?h("div",{style:{fontSize:"11px",fontWeight:"700",color:"#5A7A96"}},item.time||"TBD"):h("div",{style:{fontSize:"8px",color:GN,fontWeight:"700"}},"FINAL"),
            item.loc?h("div",{style:{fontSize:"8px",color:"#2E4560",marginTop:"2px"}},item.loc):null))))})});
  return el;
}

// â”€â”€â”€ TEAM PAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rTeam(){
  const t=gt(S.tp);const tg=S.games.filter(g=>g.home===S.tp||g.away===S.tp);
  const w=tg.filter(g=>(g.home===S.tp&&g.hs>g.as)||(g.away===S.tp&&g.as>g.hs)).length,l=tg.length-w;
  const streak=tg.slice(0,5).map(g=>(g.home===S.tp&&g.hs>g.as)||(g.away===S.tp&&g.as>g.hs));
  const el=h("div",{style:{display:"flex",flexDirection:"column",gap:"12px"}});
  el.appendChild(h("button",{style:{background:"none",border:"none",color:"#5A7A96",fontSize:"11px",fontWeight:"700",cursor:"pointer",textAlign:"left"},onClick:()=>{S.tp=null;S.tab="standings";render()}},"â† TABLA"));
  // Header with big logo
  const hdr=h("div",{style:{background:`linear-gradient(135deg,${t.c}22,#0F1F35)`,border:`1px solid ${t.c}44`,borderRadius:"4px",padding:"20px",textAlign:"center"}});
  hdr.appendChild(bd(S.tp,80));
  hdr.appendChild(h("div",{style:{fontSize:"26px",fontWeight:"900",marginTop:"8px"}},t.name));
  hdr.appendChild(h("div",{style:{fontSize:"12px",color:"#5A7A96"}},t.zone));
  hdr.appendChild(h("div",{style:{display:"flex",justifyContent:"center",gap:"16px",marginTop:"12px"}},
    h("div",{style:{textAlign:"center"}},h("div",{style:{fontSize:"28px",fontWeight:"900",color:GN}},String(w)),h("div",{style:{fontSize:"8px",color:"#3A5068"}},"GANADOS")),
    h("div",{style:{textAlign:"center"}},h("div",{style:{fontSize:"28px",fontWeight:"900",color:"#D44040"}},String(l)),h("div",{style:{fontSize:"8px",color:"#3A5068"}},"PERDIDOS")),
    h("div",{style:{textAlign:"center"}},h("div",{style:{fontSize:"28px",fontWeight:"900",color:"#5A7A96"}},tg.length?((w/tg.length*100).toFixed(0)+"%"):"â€”"),h("div",{style:{fontSize:"8px",color:"#3A5068"}},"PCT"))));
  if(streak.length)hdr.appendChild(h("div",{style:{display:"flex",gap:"4px",justifyContent:"center",marginTop:"8px"}},...streak.map(w2=>h("div",{style:{width:"16px",height:"16px",borderRadius:"4px",background:w2?GN:"#CE1126",fontSize:"9px",fontWeight:"900",color:"#E8DFD0",display:"flex",alignItems:"center",justifyContent:"center"}},w2?"V":"D"))));
  el.appendChild(hdr);
  // SPONSOR BANNER
  const sponsor=DB.get("sponsor_"+S.tp);
  if(sponsor){
    el.appendChild(h("div",{style:{background:`linear-gradient(135deg,${GD}12,${SF})`,border:"1px solid "+GD+"33",borderRadius:"4px",padding:"10px 14px",display:"flex",alignItems:"center",gap:"10px"}},
      sponsor.logo?h("img",{src:sponsor.logo,style:{width:"36px",height:"36px",borderRadius:"4px",objectFit:"cover"}}):h("div",{style:{width:"36px",height:"36px",borderRadius:"4px",background:GD+"22",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px"}},"â­"),
      h("div",{style:{flex:"1"}},
        h("div",{style:{fontSize:"8px",color:GD,fontWeight:"700",letterSpacing:"1px",fontFamily:"'Oswald',sans-serif"}},"PATROCINADOR"),
        h("div",{style:{fontSize:"13px",fontWeight:"700",color:"#E8DFD0"}},sponsor.name),
        sponsor.desc?h("div",{style:{fontSize:"9px",color:"#5A7A96"}},sponsor.desc):null)))}
  // Roster with photos
  if(t.roster?.length){const rs=h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",overflow:"hidden"}});
    rs.appendChild(h("div",{style:{padding:"12px 16px",borderBottom:"1px solid #1A335260",fontSize:"12px",fontWeight:"800",letterSpacing:"1px"}},"PLANTILLA"));
    // Player grid
    const grid=h("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(90px,1fr))",gap:"4px",padding:"10px"}});
    t.roster.forEach(p=>{
      const pStats={pts:0,gp:0};tg.forEach(g=>{g.ps?.forEach(ps=>{if(ps.nm===p.nm&&ps.tm===S.tp){pStats.pts+=ps.pts;pStats.gp++}})});
      grid.appendChild(h("div",{style:{textAlign:"center",padding:"10px 4px",background:"#1A335222",borderRadius:"4px",cursor:"pointer"},
        onClick:()=>{if(pStats.gp){S.pp=p.nm+"|||"+S.tp;S.tab="player";render()}}},
        playerPic(p.nm,S.tp,52),
        h("div",{style:{fontSize:"12px",fontWeight:"800",color:t.a,marginTop:"6px"}},"#"+p.num),
        h("div",{style:{fontSize:"10px",fontWeight:"600",color:"#B8C8D8",marginTop:"2px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},p.nm),
        h("div",{style:{fontSize:"8px",color:"#3A5068"}},p.pos||""),
        pStats.gp?h("div",{style:{fontSize:"10px",fontWeight:"800",color:AC,marginTop:"3px"}},(pStats.pts/pStats.gp).toFixed(1)+" ppj"):null))});
    rs.appendChild(grid);el.appendChild(rs)}
  // H2H
  const rivals={};tg.forEach(g=>{const opp=g.home===S.tp?g.away:g.home;if(!rivals[opp])rivals[opp]={w:0,l:0,pf:0,pa:0};const won=(g.home===S.tp&&g.hs>g.as)||(g.away===S.tp&&g.as>g.hs);rivals[opp][won?"w":"l"]++;rivals[opp].pf+=(g.home===S.tp?g.hs:g.as);rivals[opp].pa+=(g.home===S.tp?g.as:g.hs)});
  if(Object.keys(rivals).length){const h2h=h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",overflow:"hidden"}});
    h2h.appendChild(h("div",{style:{padding:"12px 16px",borderBottom:"1px solid #1A335260",fontSize:"12px",fontWeight:"800",letterSpacing:"1px"}},"âš”ï¸ CARA A CARA"));
    Object.entries(rivals).sort((a,b)=>(b[1].w+b[1].l)-(a[1].w+a[1].l)).forEach(([opp,r])=>{const o=gt(opp);
      h2h.appendChild(h("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 16px",borderBottom:"1px solid #1A335222",cursor:"pointer"},onClick:()=>{S.tp=opp;render()}},
        bd(opp,24),h("span",{style:{fontSize:"12px",color:"#B8C8D8",fontWeight:"600",flex:"1"}},o.name),
        h("span",{style:{fontSize:"14px",fontWeight:"900",color:r.w>r.l?GN:r.w<r.l?"#D44040":"#888"}},r.w+"-"+r.l),
        h("div",{style:{width:"40px",textAlign:"right"}},h("div",{style:{fontSize:"8px",color:"#3A5068"}},"+"+String(r.pf-r.pa>0?r.pf-r.pa:r.pf-r.pa)))))});
    el.appendChild(h2h)}
  // Stats table
  const stats={};tg.forEach(g=>{g.ps?.filter(p=>p.tm===S.tp).forEach(p=>{const k=p.nm+"_"+p.num;if(!stats[k])stats[k]={nm:p.nm,num:p.num,gp:0,pts:0,reb:0,ast:0,stl:0,blk:0,fgm:0,fga:0};stats[k].gp++;stats[k].pts+=p.pts;stats[k].reb+=p.reb;stats[k].ast+=p.ast;stats[k].stl+=p.stl;stats[k].blk+=p.blk;stats[k].fgm+=p.fgm;stats[k].fga+=p.fga})});
  const players=Object.values(stats).sort((a,b)=>(b.pts/b.gp)-(a.pts/a.gp));
  if(players.length){const st2=h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",overflow:"hidden"}});
    st2.appendChild(h("div",{style:{padding:"12px 16px",borderBottom:"1px solid #1A335260",fontSize:"12px",fontWeight:"800",letterSpacing:"1px"}},"PROMEDIOS"));
    const tbl=h("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"}});
    const hd=h("tr");["","JG","PTS","REB","AST","TC%"].forEach((x,i)=>hd.appendChild(h("th",{style:{padding:"5px 6px",textAlign:i?"center":"left",color:"#3A5068",fontWeight:"700",fontSize:"8px",borderBottom:"1px solid #1A335240"}},x)));tbl.appendChild(hd);
    players.forEach(p=>{const fg=p.fga>0?Math.round(p.fgm/p.fga*100):0;tbl.appendChild(h("tr",null,
      h("td",{style:{padding:"5px 6px",color:"#D0DCE8",fontWeight:"600",whiteSpace:"nowrap",cursor:"pointer"},onClick:()=>{S.pp=p.nm+"|||"+S.tp;S.tab="player";render()}},
        h("div",{style:{display:"flex",alignItems:"center",gap:"6px"}},playerPic(p.nm,S.tp,22),h("span",{style:{color:t.a,fontSize:"9px"}},"#"+p.num),h("span",null,p.nm))),
      h("td",{style:{textAlign:"center",color:"#4A6480"}},String(p.gp)),h("td",{style:{textAlign:"center",color:AC,fontWeight:"700"}},(p.pts/p.gp).toFixed(1)),
      h("td",{style:{textAlign:"center",color:"#C9A84C"}},(p.reb/p.gp).toFixed(1)),h("td",{style:{textAlign:"center",color:"#5BB8A6"}},(p.ast/p.gp).toFixed(1)),
      h("td",{style:{textAlign:"center",color:fg>=50?GN:"#888"}},fg+"%")))});
    st2.appendChild(h("div",{style:{overflowX:"auto"}},tbl));el.appendChild(st2)}
  // Games
  const rc=h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",overflow:"hidden"}});
  rc.appendChild(h("div",{style:{padding:"12px 16px",borderBottom:"1px solid #1A335260",fontSize:"12px",fontWeight:"800",letterSpacing:"1px"}},"JUEGOS"));
  tg.slice(0,10).forEach(g=>{const isH=g.home===S.tp,opp=isH?g.away:g.home,o=gt(opp),won=(isH&&g.hs>g.as)||(!isH&&g.as>g.hs);
    rc.appendChild(h("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 16px",borderBottom:"1px solid #1A335222"}},
      h("span",{style:{fontSize:"10px",fontWeight:"800",color:won?GN:"#D44040",width:"14px"}},won?"V":"D"),bd(opp,20),
      h("span",{style:{fontSize:"11px",color:"#B8C8D8",flex:"1"}},(isH?"vs":"@")+" "+o.name),
      h("span",{style:{fontSize:"12px",fontWeight:"900"}},String(isH?g.hs:g.as)+"-"+String(isH?g.as:g.hs)),h("span",{style:{fontSize:"9px",color:"#3A5068"}},g.dt)))});
  el.appendChild(rc);return el;
}

// â”€â”€â”€ PROFILE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rProfile(){
  const el=h("div",{style:{display:"flex",flexDirection:"column",gap:"12px"}});
  const users=DB.all("user_");
  if(!S.user){
    el.appendChild(h("div",{style:{fontSize:"16px",fontWeight:"900",letterSpacing:"2px"}},"ðŸ‘¤ CREAR PERFIL"));
    el.appendChild(h("div",{style:{fontSize:"10px",color:"#5A7A96",lineHeight:"1.6"}},"Ãšnete a la comunidad. Elige tu equipo y participa en los pronÃ³sticos."));
    const form=h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",padding:"14px 16px",display:"flex",flexDirection:"column",gap:"10px"}});
    form.innerHTML=`<div><div style="font-size:9px;color:#888;font-weight:700;margin-bottom:4px">NOMBRE</div><input id="pname" placeholder="Tu nombre" style="${IS}"></div>
      <div><div style="font-size:9px;color:#888;font-weight:700;margin-bottom:4px">MUNICIPIO</div><select id="pmuni" style="${IS};cursor:pointer"><option value="">â€”</option>${T.map(t=>`<option value="${t.zone}">${t.zone}</option>`).join("")}</select></div>
      <div><div style="font-size:9px;color:#888;font-weight:700;margin-bottom:4px">MI EQUIPO</div><select id="pteam" style="${IS};cursor:pointer"><option value="">â€”</option>${T.map(t=>`<option value="${t.id}">${t.name} â€” ${t.zone}</option>`).join("")}</select></div>
      <button id="preg" style="background:${AC};border:none;border-radius:4px;padding:12px;color:#fff;font-size:14px;font-weight:800;cursor:pointer;letter-spacing:2px">ðŸ€ REGISTRARME</button>`;
    el.appendChild(form);
    setTimeout(()=>{document.getElementById("preg")?.addEventListener("click",()=>{
      const name=document.getElementById("pname")?.value?.trim();if(!name)return alert("Escribe tu nombre");
      const muni=document.getElementById("pmuni")?.value;const team=document.getElementById("pteam")?.value;
      const user={name,muni,team,preds:{},joined:new Date().toISOString()};
      DB.set("my_profile",user);DB.set("user_"+name.replace(/\s/g,"_"),user);S.user=user;render()})},50);
  }else{
    const u=S.user;const t=u.team?gt(u.team):null;
    const card=h("div",{style:{background:t?`linear-gradient(135deg,${t.c}15,#0F1F35)`:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",padding:"14px 16px"}});
    card.appendChild(h("div",{style:{display:"flex",alignItems:"center",gap:"12px"}},
      u.team?bd(u.team,44):null,
      h("div",{style:{flex:"1"}},h("div",{style:{fontSize:"20px",fontWeight:"900"}},u.name),h("div",{style:{fontSize:"11px",color:"#5A7A96"}},u.muni||"La Habana"),t?h("div",{style:{fontSize:"10px",color:AC,fontWeight:"600"}},t.name):null)));
    el.appendChild(card);
    // Community
    el.appendChild(h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",padding:"14px 16px",textAlign:"center"}},
      h("div",{style:{fontSize:"36px",fontWeight:"900",color:"#C9A84C"}},String(users.length)),
      h("div",{style:{fontSize:"10px",color:"#5A7A96",letterSpacing:"1px"}},"FANS EN TABLONCILLO")));
    // PronÃ³sticos
    const upcoming=S.sched.filter(s=>s.st==="sched");
    if(upcoming.length){el.appendChild(h("div",{style:{fontSize:"14px",fontWeight:"900",color:GD,letterSpacing:"2px"}},"ðŸ”® PRONÃ“STICOS"));
      el.appendChild(h("div",{style:{fontSize:"10px",color:"#5A7A96",marginBottom:"4px"}},"Predice el ganador de cada juego"));
      upcoming.forEach(sc=>{const ht=gt(sc.home),at=gt(sc.away);const pick=u.preds?.[sc.id];
        const sec=h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",padding:"14px 16px"}});
        sec.appendChild(h("div",{style:{fontSize:"9px",color:"#3A5068",marginBottom:"8px"}},sc.dt+" Â· "+(sc.time||"TBD")+" Â· "+(sc.loc||"")));
        const grid=h("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"}});
        [{tid:sc.away,t:at},{tid:sc.home,t:ht}].forEach(x=>{
          grid.appendChild(h("button",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px",background:pick===x.tid?x.t.c+"33":"#1A335230",border:pick===x.tid?"2px solid "+x.t.c:"2px solid #1A335260",borderRadius:"4px",cursor:"pointer",textAlign:"left"},
            onClick:()=>{if(!S.user.preds)S.user.preds={};S.user.preds[sc.id]=x.tid;DB.set("my_profile",S.user);DB.set("user_"+S.user.name.replace(/\s/g,"_"),S.user);render()}},
            bd(x.tid,28),h("div",null,h("div",{style:{fontSize:"12px",fontWeight:"700",color:pick===x.tid?"#fff":"#999"}},x.t.name),h("div",{style:{fontSize:"9px",color:"#3A5068"}},x.t.zone)),
            pick===x.tid?h("span",{style:{marginLeft:"auto",fontSize:"14px"}},"âœ…"):null))});
        sec.appendChild(grid);el.appendChild(sec)})}
    // Leaderboard
    const lb=users.filter(u2=>u2.preds&&Object.keys(u2.preds).length>0).map(u2=>{
      let c=0,tot=0;Object.entries(u2.preds||{}).forEach(([sid,pick])=>{const g=S.games.find(g2=>g2.schedRef===sid);if(!g)return;tot++;if((g.hs>g.as?g.home:g.away)===pick)c++});
      return{...u2,correct:c,total:tot}}).sort((a,b)=>b.correct-a.correct);
    if(lb.length){const lbSec=h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",overflow:"hidden"}});
      lbSec.appendChild(h("div",{style:{padding:"10px 16px",borderBottom:"1px solid #1A335260"}},h("span",{style:{fontSize:"11px",fontWeight:"800",color:GD,letterSpacing:"1px"}},"ðŸ† RANKING PRONOSTICADORES")));
      lb.slice(0,10).forEach((u2,i)=>{lbSec.appendChild(h("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 16px",borderBottom:"1px solid #1A335222",background:u2.name===u.name?AC+"08":"transparent"}},
        h("span",{style:{fontSize:"14px",fontWeight:"900",color:i===0?GD:i===1?"#C0C0C0":i===2?"#CD7F32":"#555",width:"20px"}},String(i+1)),
        u2.team?bd(u2.team,20):null,h("div",{style:{flex:"1"}},h("div",{style:{fontSize:"12px",color:u2.name===u.name?AC:"#ddd",fontWeight:"600"}},u2.name)),
        h("span",{style:{fontSize:"16px",fontWeight:"900",color:GN}},String(u2.correct)),h("span",{style:{fontSize:"10px",color:"#3A5068"}},"/"+u2.total)))});
      el.appendChild(lbSec)}
    el.appendChild(h("div",{style:{display:"flex",justifyContent:"center",gap:"8px",marginTop:"8px"}},...["ig","fb","tt","yt","wa"].map(k=>socialBtn(k,SOCIAL[k])).filter(Boolean)));
    el.appendChild(h("button",{style:{background:`linear-gradient(135deg,${GD}22,#0F1F35)`,border:`1px solid ${GD}44`,borderRadius:"4px",padding:"12px 16px",cursor:"pointer",width:"100%",display:"flex",alignItems:"center",gap:"10px",textAlign:"left",marginTop:"4px"},
      onClick:()=>{S.tab="allstar";render()}},
      h("span",{style:{fontSize:"20px"}},"â­"),h("div",{style:{flex:"1"}},h("div",{style:{fontSize:"13px",fontWeight:"800",color:GD}},"ALL-STAR HABANA"),h("div",{style:{fontSize:"10px",color:"#5A7A96"}},"Vota por los 5 mejores jugadores"))));
    el.appendChild(h("button",{style:{background:"#1A335240",border:"1px solid #1A335280",borderRadius:"8px",padding:"10px",color:"#5A7A96",fontSize:"10px",fontWeight:"700",cursor:"pointer",width:"100%"},onClick:()=>{S.user=null;DB.del("my_profile");render()}},"Cerrar sesiÃ³n"));}
  return el;
}

// â”€â”€â”€ COURTSIDE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Buzzer sound via Web Audio API
function playBuzz(type){try{const ctx=new(window.AudioContext||window.webkitAudioContext)();const osc=ctx.createOscillator();const g=ctx.createGain();osc.connect(g);g.connect(ctx.destination);
  if(type==="shot"){osc.frequency.value=880;g.gain.value=0.5;osc.start();osc.stop(ctx.currentTime+0.5)}
  else{osc.frequency.value=440;g.gain.value=0.6;osc.start();setTimeout(()=>{osc.frequency.value=520},300);osc.stop(ctx.currentTime+1.2)}}catch(e){}}

function fmtTime(s){return String(Math.floor(s/60)).padStart(2,"0")+":"+String(s%60).padStart(2,"0")}

function rCourt(){
  const c=S.court;if(!c)return h("div");
  if(!c.live){// Setup
    const el=h("div",{style:{display:"flex",flexDirection:"column",gap:"10px"}});
    el.innerHTML=`<div style="font-size:20px;font-weight:900;letter-spacing:3px;text-align:center">ðŸ€ MODO CANCHA</div>
      <div style="font-size:10px;color:#888;text-align:center">EstadÃ­sticas en vivo desde la cancha</div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
        <div><div style="font-size:9px;color:#888;font-weight:700;margin-bottom:4px">VISITANTE</div><select id="caway" style="${IS};cursor:pointer"><option value="">â€”</option>${T.filter(t=>t.roster?.length).map(t=>`<option value="${t.id}">${t.name} (${t.roster.length})</option>`).join("")}</select></div>
        <div><div style="font-size:9px;color:#888;font-weight:700;margin-bottom:4px">LOCAL</div><select id="chome" style="${IS};cursor:pointer"><option value="">â€”</option>${T.filter(t=>t.roster?.length).map(t=>`<option value="${t.id}">${t.name} (${t.roster.length})</option>`).join("")}</select></div></div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
        <div><div style="font-size:9px;color:#888;font-weight:700;margin-bottom:4px">LUGAR</div><input id="cloc" placeholder="Sala RamÃ³n Fonst" style="${IS}"></div>
        <div><div style="font-size:9px;color:#888;font-weight:700;margin-bottom:4px">MIN/CUARTO</div><select id="cqmin" style="${IS};cursor:pointer"><option value="600">10 min</option><option value="480">8 min</option><option value="720">12 min</option></select></div></div>
      <button id="cstart" style="background:${AC};border:none;border-radius:4px;padding:16px;color:#fff;font-size:18px;font-weight:800;cursor:pointer;letter-spacing:3px">ðŸ€ COMENZAR</button>`;
    setTimeout(()=>{document.getElementById("cstart")?.addEventListener("click",()=>{
      const away=document.getElementById("caway")?.value,home=document.getElementById("chome")?.value;
      if(!away||!home||away===home)return alert("Selecciona dos equipos diferentes");
      const qSec=parseInt(document.getElementById("cqmin")?.value)||600;
      S.court={live:true,away,home,loc:document.getElementById("cloc")?.value||"",q:1,period:"Q1",
        qs:[[0,0],[0,0],[0,0],[0,0]],stats:{},log:[],scoringTm:null,desc:"",
        shotClock:24,shotInterval:null,shotRunning:false,
        gameClock:qSec,gameInterval:null,gameRunning:false,qSec,
        activePlayer:null,startTime:new Date().toISOString()};render()})},50);
    return el;
  }
  // â•â•â• LIVE SCORING â•â•â•
  const{away,home,q,qs,stats,log,scoringTm}=c;
  const at=gt(away),ht=gt(home);
  const aTotal=qs.reduce((s,x)=>s+x[0],0),hTotal=qs.reduce((s,x)=>s+x[1],0);
  const getSt=pid=>stats[pid]||{pts:0,reb:0,ast:0,stl:0,blk:0,fgm:0,fga:0,fouls:0,ftm:0,fta:0};
  const periods=["Q1","Q2","HT","Q3","Q4"];
  const el=h("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}});

  // â”€â”€ SCOREBOARD â”€â”€
  const sb=h("div",{style:{background:"linear-gradient(135deg,#111,#0F1F35)",border:"1px solid #1A335280",borderRadius:"4px",padding:"10px 14px"}});
  // Game clock (big, centered)
  sb.appendChild(h("div",{style:{textAlign:"center",marginBottom:"4px"}},
    h("span",{id:"gameclock",style:{fontSize:"28px",fontWeight:"900",color:c.gameClock<=60?"#CE1126":"#fff",fontFamily:"monospace",letterSpacing:"2px"}},fmtTime(c.gameClock)),
    h("span",{style:{fontSize:"10px",color:"#3A5068",marginLeft:"6px"}},c.period==="HT"?"DESCANSO":c.period)));
  // Teams + scores
  sb.appendChild(h("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"8px"}},
    h("div",{style:{flex:"1",textAlign:"center",cursor:"pointer",padding:"6px",borderRadius:"4px",background:scoringTm===away?at.c+"33":"transparent",border:scoringTm===away?"2px solid "+at.c:"2px solid transparent"},onClick:()=>{c.scoringTm=away;render()}},
      bd(away,22),h("div",{style:{fontSize:"8px",fontWeight:"700",color:scoringTm===away?"#fff":"#888",marginTop:"1px"}},at.name),
      h("div",{style:{fontSize:"40px",fontWeight:"900",color:aTotal>=hTotal?"#fff":"#555",lineHeight:"1"}},String(aTotal))),
    h("div",{style:{textAlign:"center"}},
      h("div",{style:{fontSize:"18px",color:"#253A52",fontWeight:"900"}},"â€”"),
      h("div",{id:"shotclock",style:{fontSize:"22px",fontWeight:"900",color:c.shotClock<=5?"#CE1126":GD,fontFamily:"monospace"}},String(c.shotClock))),
    h("div",{style:{flex:"1",textAlign:"center",cursor:"pointer",padding:"6px",borderRadius:"4px",background:scoringTm===home?ht.c+"33":"transparent",border:scoringTm===home?"2px solid "+ht.c:"2px solid transparent"},onClick:()=>{c.scoringTm=home;render()}},
      bd(home,22),h("div",{style:{fontSize:"8px",fontWeight:"700",color:scoringTm===home?"#fff":"#888",marginTop:"1px"}},ht.name),
      h("div",{style:{fontSize:"40px",fontWeight:"900",color:hTotal>=aTotal?"#fff":"#555",lineHeight:"1"}},String(hTotal)))));
  // Quarter scores
  sb.appendChild(h("div",{style:{display:"flex",justifyContent:"center",gap:"10px",marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #1A335240"}},
    ...qs.map((qr,i)=>h("div",{style:{textAlign:"center",opacity:i<q?"1":".3"}},h("span",{style:{fontSize:"7px",color:"#2E4560"}},"Q"+(i+1)),h("div",{style:{fontSize:"9px",color:"#4A6480"}},qr[0]+"-"+qr[1])))));
  el.appendChild(sb);

  // â”€â”€ CLOCK CONTROLS â”€â”€
  const clockRow=h("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px"}});
  // Game clock button
  clockRow.appendChild(h("button",{style:{padding:"8px",background:c.gameRunning?"#CE112622":GN+"22",border:"1px solid "+(c.gameRunning?"#CE112644":GN+"44"),borderRadius:"8px",color:c.gameRunning?"#CE1126":GN,fontSize:"11px",fontWeight:"800",cursor:"pointer"},
    onClick:()=>{
      if(c.gameRunning){clearInterval(c.gameInterval);clearInterval(c.shotInterval);c.gameRunning=false;c.shotRunning=false}
      else{c.gameRunning=true;c.shotRunning=true;
        c.gameInterval=setInterval(()=>{c.gameClock--;const el2=document.getElementById("gameclock");
          if(el2){el2.textContent=fmtTime(c.gameClock);if(c.gameClock<=60)el2.style.color="#CE1126"}
          if(c.gameClock<=0){clearInterval(c.gameInterval);clearInterval(c.shotInterval);c.gameRunning=false;c.shotRunning=false;c.gameClock=0;playBuzz("game");render()}},1000);
        c.shotInterval=setInterval(()=>{c.shotClock--;const el3=document.getElementById("shotclock");
          if(el3){el3.textContent=String(c.shotClock);if(c.shotClock<=5)el3.style.color="#CE1126";else el3.style.color=GD}
          if(c.shotClock<=0){clearInterval(c.shotInterval);c.shotRunning=false;c.shotClock=0;playBuzz("shot");render()}},1000)}
      render()}},c.gameRunning?"â¸ PARAR RELOJES":"â–¶ï¸ INICIAR RELOJES"));
  // Shot clock resets
  clockRow.appendChild(h("div",{style:{display:"flex",gap:"4px"}},
    h("button",{style:{flex:"1",padding:"8px",background:GD+"22",border:"1px solid "+GD+"44",borderRadius:"8px",color:GD,fontSize:"11px",fontWeight:"800",cursor:"pointer"},
      onClick:()=>{c.shotClock=24;clearInterval(c.shotInterval);c.shotRunning=false;if(c.gameRunning){c.shotRunning=true;c.shotInterval=setInterval(()=>{c.shotClock--;const el3=document.getElementById("shotclock");if(el3){el3.textContent=String(c.shotClock);el3.style.color=c.shotClock<=5?"#CE1126":GD}if(c.shotClock<=0){clearInterval(c.shotInterval);c.shotRunning=false;playBuzz("shot");render()}},1000)}render()}},"ðŸ”„ 24"),
    h("button",{style:{flex:"1",padding:"8px",background:GD+"22",border:"1px solid "+GD+"44",borderRadius:"8px",color:GD,fontSize:"11px",fontWeight:"800",cursor:"pointer"},
      onClick:()=>{c.shotClock=14;clearInterval(c.shotInterval);c.shotRunning=false;if(c.gameRunning){c.shotRunning=true;c.shotInterval=setInterval(()=>{c.shotClock--;const el3=document.getElementById("shotclock");if(el3){el3.textContent=String(c.shotClock);el3.style.color=c.shotClock<=5?"#CE1126":GD}if(c.shotClock<=0){clearInterval(c.shotInterval);c.shotRunning=false;playBuzz("shot");render()}},1000)}render()}},"ðŸ”„ 14")));
  el.appendChild(clockRow);

  // â”€â”€ PERIOD TABS â”€â”€
  el.appendChild(h("div",{style:{display:"flex",gap:"0"}},
    ...periods.map((p,i)=>h("button",{style:{flex:"1",padding:"5px 0",background:c.period===p?(p==="HT"?GD+"33":AC+"33"):"transparent",border:"1px solid "+(c.period===p?(p==="HT"?GD+"66":AC+"66"):"#1A335260"),borderRadius:i===0?"8px 0 0 8px":i===4?"0 8px 8px 0":"0",borderLeft:i>0?"none":"",color:c.period===p?(p==="HT"?GD:AC):"#555",fontSize:"10px",fontWeight:"800",cursor:"pointer"},
      onClick:()=>{clearInterval(c.gameInterval);clearInterval(c.shotInterval);c.gameRunning=false;c.shotRunning=false;
        c.period=p;if(p!=="HT"){c.q=parseInt(p[1]);c.gameClock=c.qSec;c.shotClock=24}render()}},p))));

  // â”€â”€ TEAM SELECTOR â”€â”€
  if(!scoringTm){el.appendChild(h("div",{style:{textAlign:"center",padding:"20px",fontSize:"12px",color:"#5A7A96",background:"#0F1F35",borderRadius:"4px",border:"1px solid #1A335260"}},"ðŸ‘† Toca un equipo en el marcador para anotar"));return el}

  const t=gt(scoringTm);
  // â”€â”€ PLAYER CHIPS â”€â”€
  const pInput=h("div",{style:{background:`linear-gradient(135deg,${t.c}15,#0F1F35)`,border:`1px solid ${t.c}44`,borderRadius:"4px",padding:"10px"}});
  pInput.appendChild(h("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"}},bd(scoringTm,18),h("span",{style:{fontSize:"11px",fontWeight:"800"}},t.name)));
  const chips=h("div",{style:{display:"flex",gap:"4px",flexWrap:"wrap",marginBottom:"6px"}});
  (t.roster||[]).forEach(p=>{const pid=p.nm+"_"+scoringTm;const ps=getSt(pid);
    chips.appendChild(h("button",{style:{padding:"6px 8px",background:c.activePlayer===pid?t.c+"55":"#1A335250",border:c.activePlayer===pid?"2px solid "+t.c:"1px solid #1A335280",borderRadius:"4px",cursor:"pointer",textAlign:"center",minWidth:"52px"},
      onClick:()=>{c.activePlayer=c.activePlayer===pid?null:pid;render()}},
      h("div",{style:{fontSize:"13px",fontWeight:"900",color:t.a}},"#"+p.num),
      h("div",{style:{fontSize:"8px",color:c.activePlayer===pid?"#fff":"#aaa",fontWeight:"600",maxWidth:"55px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},p.nm.split(" ").pop()),
      ps.pts>0?h("div",{style:{fontSize:"11px",fontWeight:"900",color:AC}},String(ps.pts)):null))});
  pInput.appendChild(chips);
  // Manual # entry
  pInput.appendChild(h("div",{style:{display:"flex",gap:"6px",alignItems:"center"}},
    h("span",{style:{fontSize:"10px",color:"#5A7A96"}},"#"),
    h("input",{id:"pnum",type:"number",placeholder:"Num",style:"background:#1A335280;border:1px solid rgba(255,255,255,.12);border-radius:8px;padding:6px;color:#fff;font-size:14px;font-weight:900;width:50px;text-align:center;outline:none",
      onInput:e=>{const num=e.target.value;const p=(t.roster||[]).find(r=>r.num===num);const nameEl=document.getElementById("pnameshow");
        if(p&&nameEl){nameEl.textContent=p.nm;nameEl.style.color="#fff";c.activePlayer=p.nm+"_"+scoringTm}
        else if(nameEl){nameEl.textContent=num?"?":"";nameEl.style.color="#555";c.activePlayer=null}}}),
    h("span",{id:"pnameshow",style:{fontSize:"13px",fontWeight:"700",color:"#3A5068",flex:"1"}},
      c.activePlayer?(t.roster||[]).find(r=>r.nm+"_"+scoringTm===c.activePlayer)?.nm||"":""),
    c.activePlayer?h("span",{style:{fontSize:"18px",fontWeight:"900",color:AC}},String(getSt(c.activePlayer).pts)+" pts"):null));
  el.appendChild(pInput);

  // â”€â”€ SCORING BUTTONS â”€â”€
  if(c.activePlayer){
    const ap=c.activePlayer;const ps=getSt(ap);
    const addSt=(stat)=>{
      if(!c.stats[ap])c.stats[ap]={pts:0,reb:0,ast:0,stl:0,blk:0,fgm:0,fga:0,fouls:0,ftm:0,fta:0};
      const s=c.stats[ap];let pts=0;const tm=ap.split("_").pop();const pName=ap.split("_")[0];
      if(stat==="fg2"){s.pts+=2;s.fgm++;s.fga++;pts=2}
      else if(stat==="fg3"){s.pts+=3;s.fgm++;s.fga++;pts=3}
      else if(stat==="ft"){s.pts+=1;s.ftm++;s.fta++;pts=1}
      else if(stat==="miss"){s.fga++}
      else if(stat==="ftmiss"){s.fta++}
      else if(stat==="foul"){s.fouls++}
      else{s[stat]=(s[stat]||0)+1}
      if(pts){c.qs[c.q-1][tm===c.away?0:1]+=pts}
      const time=fmtTime(c.gameClock);
      const label=pts?"+"+pts:stat==="miss"?"FALLO":stat==="ftmiss"?"FT FALLO":stat==="foul"?"FALTA":stat.toUpperCase();
      c.log.unshift({p:pName,num:(t.roster||[]).find(r=>r.nm+"_"+scoringTm===ap)?.num||"?",tm,stat:label,q:c.period,time,pts});
      if(pts>=2){c.shotClock=24;clearInterval(c.shotInterval);c.shotRunning=false;
        if(c.gameRunning){c.shotRunning=true;c.shotInterval=setInterval(()=>{c.shotClock--;const el3=document.getElementById("shotclock");if(el3){el3.textContent=String(c.shotClock);el3.style.color=c.shotClock<=5?"#CE1126":GD}if(c.shotClock<=0){clearInterval(c.shotInterval);c.shotRunning=false;playBuzz("shot");render()}},1000)}}
      render()};
    el.appendChild(h("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"6px"}},
      h("button",{style:{padding:"16px 4px",background:"#C9A84C22",border:"2px solid #C9A84C44",borderRadius:"4px",color:"#C9A84C",fontSize:"20px",fontWeight:"900",cursor:"pointer",textAlign:"center"},onClick:()=>addSt("ft")},h("div",null,"+1"),h("div",{style:{fontSize:"8px",fontWeight:"700",marginTop:"2px"}},"TIRO LIBRE")),
      h("button",{style:{padding:"16px 4px",background:AC+"22",border:"2px solid "+AC+"44",borderRadius:"4px",color:AC,fontSize:"20px",fontWeight:"900",cursor:"pointer",textAlign:"center"},onClick:()=>addSt("fg2")},h("div",null,"+2"),h("div",{style:{fontSize:"8px",fontWeight:"700",marginTop:"2px"}},"DOBLE")),
      h("button",{style:{padding:"16px 4px",background:GD+"22",border:"2px solid "+GD+"44",borderRadius:"4px",color:GD,fontSize:"20px",fontWeight:"900",cursor:"pointer",textAlign:"center"},onClick:()=>addSt("fg3")},h("div",null,"+3"),h("div",{style:{fontSize:"8px",fontWeight:"700",marginTop:"2px"}},"TRIPLE"))));
    el.appendChild(h("div",{style:{display:"grid",gridTemplateColumns:"repeat(5,1fr)",gap:"4px"}},
      ...[["miss","âŒFALLO","#555"],["reb","ðŸ’ªREB","#C9A84C"],["ast","ðŸŽ¯AST","#5BB8A6"],["stl","ðŸ‘‹ROB",GD],["blk","ðŸ–BLQ","#D44040"]].map(([stat,label,clr])=>
        h("button",{style:{padding:"7px 2px",background:clr+"15",border:"1px solid "+clr+"33",borderRadius:"8px",color:clr,fontSize:"7px",fontWeight:"800",cursor:"pointer",textAlign:"center"},onClick:()=>addSt(stat)},label))));
    el.appendChild(h("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px"}},
      h("button",{style:{padding:"6px",background:"rgba(255,59,48,.1)",border:"1px solid rgba(255,59,48,.3)",borderRadius:"8px",color:"#D44040",fontSize:"9px",fontWeight:"800",cursor:"pointer"},onClick:()=>addSt("foul")},"âš ï¸ FALTA"+(ps.fouls?" ("+ps.fouls+")":"")),
      h("button",{style:{padding:"6px",background:"#1A335230",border:"1px solid #1A335260",borderRadius:"8px",color:"#5A7A96",fontSize:"9px",fontWeight:"800",cursor:"pointer"},onClick:()=>addSt("ftmiss")},"FT FALLO")));
    el.appendChild(h("div",{style:{display:"flex",gap:"6px",justifyContent:"center",padding:"3px 0",fontSize:"9px",color:"#5A7A96"}},
      ...[["PTS",ps.pts,AC],["REB",ps.reb,"#C9A84C"],["AST",ps.ast,"#5BB8A6"],["ROB",ps.stl,GD],["BLQ",ps.blk,"#D44040"],["FAL",ps.fouls,"#D44040"]].map(([k,v,clr])=>
        h("span",null,h("span",{style:{color:clr,fontWeight:"700"}},String(v||0))," "+k))));}

  // â”€â”€ UNDO â”€â”€
  el.appendChild(h("button",{style:{width:"100%",padding:"7px",background:"#1A335240",border:"1px solid #1A335280",borderRadius:"8px",color:log.length?"#aaa":"#333",fontSize:"9px",fontWeight:"700",cursor:"pointer"},
    onClick:()=>{if(!log.length)return;const last=log[0];const pts=last.pts||0;const qi=last.q==="Q1"?0:last.q==="Q2"?1:last.q==="Q3"?2:3;
      if(pts){c.qs[qi][last.tm===c.away?0:1]-=pts;const pid=last.p+"_"+last.tm;if(c.stats[pid]){c.stats[pid].pts-=pts;c.stats[pid].fga--;if(pts>=2)c.stats[pid].fgm--;if(pts===1){c.stats[pid].ftm--;c.stats[pid].fta--}}}
      else if(last.stat==="FALLO"){const pid=last.p+"_"+last.tm;if(c.stats[pid])c.stats[pid].fga--}
      else if(last.stat==="FT FALLO"){const pid=last.p+"_"+last.tm;if(c.stats[pid])c.stats[pid].fta--}
      else if(last.stat==="FALTA"){const pid=last.p+"_"+last.tm;if(c.stats[pid])c.stats[pid].fouls--}
      else{const key=last.stat.toLowerCase();const pid=last.p+"_"+last.tm;if(c.stats[pid]&&c.stats[pid][key])c.stats[pid][key]--}
      c.log.shift();render()}},"â†©ï¸ DESHACER"));

  // â”€â”€ FINISH â”€â”€
  el.appendChild(h("div",null,h("div",{style:{fontSize:"9px",color:"#5A7A96",fontWeight:"700",marginBottom:"4px"}},"ðŸ“ DESCRIPCIÃ“N"),
    h("input",{value:c.desc||"",style:IS,placeholder:"Resumen del juego...",onInput:e=>{c.desc=e.target.value}})));
  el.appendChild(h("button",{style:{background:"linear-gradient(135deg,#CE1126,#ff6b35)",border:"none",borderRadius:"4px",padding:"14px",color:"#E8DFD0",fontSize:"14px",fontWeight:"800",cursor:"pointer",letterSpacing:"2px"},
    onClick:()=>{
      clearInterval(c.gameInterval);clearInterval(c.shotInterval);
      const ps=Object.entries(c.stats).map(([k,s])=>{const[nm,tm]=k.split("_");const p=(gt(tm).roster||[]).find(r=>r.nm===nm);
        return{nm,num:p?.num||"0",tm,min:20,pts:s.pts,reb:s.reb,ast:s.ast,stl:s.stl,blk:s.blk,fgm:s.fgm,fga:s.fga,fouls:s.fouls||0,ftm:s.ftm||0,fta:s.fta||0}});
      const g={id:"game_"+Date.now(),home:c.home,away:c.away,hs:hTotal,as:aTotal,dt:new Date().toISOString().split("T")[0],loc:c.loc,desc:c.desc||undefined,qs:c.qs,ps,createdAt:Date.now(),by:S.user?.name||"Reporter"};
      DB.set(g.id,g);S.games.unshift(g);
      // Generate PDF via printable HTML
      const pdfHtml=genBoxScorePDF(g,c.log.slice().reverse());
      const w=window.open("","_blank");if(w){w.document.write(pdfHtml);w.document.close()}
      // Copy share data
      const compact=btoa(unescape(encodeURIComponent(JSON.stringify(g))));
      try{navigator.clipboard.writeText("ðŸ€TB|"+compact)}catch(e){}
      alert("âœ… Juego guardado!\\nðŸ“„ PDF abierto en nueva pestaÃ±a (Ctrl+P para imprimir/guardar)\\nðŸ“‹ Datos copiados para WhatsApp");
      S.court=null;S.tab="scores";render()}},"ðŸ FINALIZAR Y EXPORTAR PDF"));

  // â”€â”€ PLAY LOG â”€â”€
  if(log.length){const lg=h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",overflow:"hidden",marginTop:"4px"}});
    lg.appendChild(h("div",{style:{padding:"6px 12px",borderBottom:"1px solid #1A335260",display:"flex",justifyContent:"space-between"}},
      h("span",{style:{fontSize:"9px",fontWeight:"800",color:"#5A7A96"}},"ðŸ“‹ JUGADAS ("+log.length+")"),
      h("span",{style:{fontSize:"10px",fontWeight:"900",color:AC}},aTotal+" â€” "+hTotal)));
    const list=h("div",{style:{maxHeight:"120px",overflowY:"auto"}});
    log.forEach((l,i)=>{const lt=gt(l.tm);const isPts=l.pts>0;
      list.appendChild(h("div",{style:{padding:"4px 12px",borderBottom:"1px solid #1A335222",display:"flex",alignItems:"center",gap:"5px",background:i===0?"rgba(255,107,53,.04)":"transparent"}},
        h("span",{style:{fontSize:"7px",color:"#2E4560",width:"18px"}},l.q),
        h("span",{style:{fontSize:"8px",color:"#3A5068",width:"38px",fontFamily:"monospace"}},l.time),
        h("div",{style:{width:"6px",height:"6px",borderRadius:"3px",background:lt.c}}),
        h("span",{style:{fontSize:"9px",color:lt.a,fontWeight:"700",width:"18px"}},"#"+l.num),
        h("span",{style:{fontSize:"9px",color:"#B8C8D8",flex:"1"}},l.p),
        h("span",{style:{fontSize:"11px",fontWeight:"900",color:isPts?AC:"#666"}},l.stat)))});
    lg.appendChild(list);el.appendChild(lg)}
  return el;
}

// PDF Generator
function genBoxScorePDF(g,plays){
  const at=gt(g.away),ht=gt(g.home);const aTotal=g.as,hTotal=g.hs;
  const mkTeamRows=(tm)=>{const ps=(g.ps||[]).filter(p=>p.tm===tm).sort((a,b)=>b.pts-a.pts);
    let rows="";ps.forEach(p=>{const fg=p.fga>0?Math.round(p.fgm/p.fga*100):0;const ft=p.fta>0?Math.round(p.ftm/p.fta*100):0;
      rows+=`<tr><td style="text-align:left;font-weight:600">#${p.num} ${p.nm}</td><td>${p.pts}</td><td>${p.reb}</td><td>${p.ast}</td><td>${p.stl}</td><td>${p.blk}</td><td>${p.fgm}/${p.fga}</td><td>${fg}%</td><td>${p.ftm||0}/${p.fta||0}</td><td>${ft}%</td><td>${p.fouls||0}</td></tr>`});
    const tot=ps.reduce((a,p)=>({pts:a.pts+p.pts,reb:a.reb+p.reb,ast:a.ast+p.ast,stl:a.stl+p.stl,blk:a.blk+p.blk}),{pts:0,reb:0,ast:0,stl:0,blk:0});
    rows+=`<tr style="font-weight:900;border-top:2px solid #333;background:#f5f5f5"><td style="text-align:left">TOTAL</td><td>${tot.pts}</td><td>${tot.reb}</td><td>${tot.ast}</td><td>${tot.stl}</td><td>${tot.blk}</td><td></td><td></td><td></td><td></td><td></td></tr>`;
    return rows};
  const qs=g.qs||[[0,0],[0,0],[0,0],[0,0]];
  let playRows="";(plays||[]).forEach(l=>{playRows+=`<tr><td>${l.q}</td><td>${l.time}</td><td>${gt(l.tm).name}</td><td>#${l.num}</td><td>${l.p}</td><td style="font-weight:700">${l.stat}</td></tr>`});
  return `<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Box Score - ${at.name} vs ${ht.name}</title>
<style>@media print{body{margin:0}}.page{max-width:800px;margin:0 auto;padding:24px;font-family:Arial,sans-serif;color:#111;font-size:11px}
h1{font-size:20px;text-align:center;margin:0}h2{font-size:14px;margin:16px 0 6px;border-bottom:2px solid #333;padding-bottom:4px}
.hdr{text-align:center;margin-bottom:16px}.score{font-size:36px;font-weight:900}.vs{font-size:14px;color:#888;margin:0 12px}
.meta{font-size:10px;color:#666;margin-top:4px}
table{width:100%;border-collapse:collapse;margin-bottom:12px;font-size:10px}th{background:#222;color:#fff;padding:5px 6px;text-align:center;font-size:9px}
td{padding:4px 6px;text-align:center;border-bottom:1px solid #ddd}.qbox{display:inline-block;margin:0 8px;text-align:center}
.qbox span{display:block;font-size:9px;color:#888}.qbox b{font-size:12px}
</style></head><body><div class="page">
<div style="text-align:center;margin-bottom:4px"><img src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='1' height='1'/>" style="display:none"><b style="font-size:16px;letter-spacing:3px">ðŸ€ TABLONCILLO</b></div>
<div class="hdr"><div style="display:flex;justify-content:center;align-items:center;gap:16px">
<div><div style="font-size:13px;font-weight:700">${at.name}</div><div class="score">${aTotal}</div></div>
<span class="vs">â€”</span>
<div><div style="font-size:13px;font-weight:700">${ht.name}</div><div class="score">${hTotal}</div></div></div>
<div style="margin-top:8px">${["Q1","Q2","Q3","Q4"].map((q,i)=>`<span class="qbox"><span>${q}</span><b>${qs[i][0]}-${qs[i][1]}</b></span>`).join("")}</div>
<div class="meta">${g.dt} Â· ${g.loc||""} Â· Reportado por ${g.by||"â€”"}</div>
${g.desc?`<div style="margin-top:4px;font-style:italic;color:#555">${g.desc}</div>`:""}</div>
<h2>${at.name}</h2>
<table><tr><th style="text-align:left">JUGADOR</th><th>PTS</th><th>REB</th><th>AST</th><th>ROB</th><th>BLQ</th><th>TC</th><th>TC%</th><th>TL</th><th>TL%</th><th>FAL</th></tr>${mkTeamRows(g.away)}</table>
<h2>${ht.name}</h2>
<table><tr><th style="text-align:left">JUGADOR</th><th>PTS</th><th>REB</th><th>AST</th><th>ROB</th><th>BLQ</th><th>TC</th><th>TC%</th><th>TL</th><th>TL%</th><th>FAL</th></tr>${mkTeamRows(g.home)}</table>
${playRows?`<h2>JUGADA POR JUGADA</h2><table><tr><th>PER</th><th>RELOJ</th><th>EQUIPO</th><th>#</th><th>JUGADOR</th><th>ACCIÃ“N</th></tr>${playRows}</table>`:""}
<div style="text-align:center;margin-top:16px;font-size:9px;color:#aaa">tabloncillo.github.io Â· Liga de La Habana</div>
</div></body></html>`}

// â”€â”€â”€ ADMIN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rAdmin(){
  if(!S.adminTab)S.adminTab="report";
  const el=h("div",{style:{display:"flex",flexDirection:"column",gap:"10px"}});
  const subTabs=S.admin?[["report","DATOS"],["teams","EQUIPOS"],["bracket","BRACKET"],["tools","HERRAMIENTAS"]]:[["report","DATOS"],["teams","EQUIPOS"]];
  el.appendChild(h("div",{style:{display:"flex",gap:"0",border:"1px solid "+BD,borderRadius:"2px",overflow:"hidden"}},
    ...subTabs.map((tb,i)=>h("button",{style:{flex:"1",padding:"9px 0",background:S.adminTab===tb[0]?AC:"transparent",borderRight:i<subTabs.length-1?"1px solid "+BD:"none",color:S.adminTab===tb[0]?"#E8DFD0":"#5A7A96",fontSize:"9px",fontWeight:"700",cursor:"pointer",letterSpacing:"1px",fontFamily:"'Oswald',sans-serif",border:"none"},
      onClick:()=>{S.adminTab=tb[0];render()}},tb[1]))));

  if(S.adminTab==="report")el.appendChild(rAdminReport());
  else if(S.adminTab==="teams")el.appendChild(rAdminTeams());
  else if(S.adminTab==="bracket")el.appendChild(rAdminBracket());
  else if(S.adminTab==="tools")el.appendChild(rAdminTools());
  return el;
}

function rAdminReport(){
  const el=h("div",{style:{display:"flex",flexDirection:"column",gap:"10px"}});
  // CANCHA LAUNCHER â€” primary action
  el.appendChild(h("div",{style:{background:`linear-gradient(135deg,${AC}22,${SF})`,border:"2px solid "+AC+"44",borderRadius:"4px",padding:"20px",textAlign:"center",cursor:"pointer"},onClick:()=>{S.court={live:false};render()}},
    h("img",{src:LOGO_IMG,style:{width:"32px",height:"32px",filter:"invert(.92) brightness(1.1) sepia(.15) saturate(5) hue-rotate(340deg)"}}),
    h("div",{style:{fontSize:"20px",fontWeight:"700",color:"#E8DFD0",marginTop:"8px",fontFamily:"'Oswald',sans-serif",letterSpacing:"3px"}},"ABRIR CANCHA"),
    h("div",{style:{fontSize:"10px",color:"#5A7A96",marginTop:"4px"}},"Modo courtside â€” marcador en vivo, reloj, jugada por jugada")));
  // SCHEDULE GAME
  el.appendChild(h("div",{style:{fontSize:"14px",fontWeight:"700",color:GD,letterSpacing:"2px",fontFamily:"'Oswald',sans-serif"}},"PROGRAMAR JUEGO"));
  el.innerHTML+=`<div style="background:${SF};border:1px solid ${BD};border-radius:4px;padding:14px 16px">
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
    <div><div style="font-size:9px;color:#5A7A96;font-weight:700;margin-bottom:4px;font-family:'Oswald',sans-serif;letter-spacing:1px">VISITANTE</div><select id="aa" style="${IS};cursor:pointer"><option value="">â€”</option>${T.map(t=>`<option value="${t.id}">${t.name}</option>`).join("")}</select></div>
    <div><div style="font-size:9px;color:#5A7A96;font-weight:700;margin-bottom:4px;font-family:'Oswald',sans-serif;letter-spacing:1px">LOCAL</div><select id="ah" style="${IS};cursor:pointer"><option value="">â€”</option>${T.map(t=>`<option value="${t.id}">${t.name}</option>`).join("")}</select></div></div>
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px">
    <div><div style="font-size:9px;color:#5A7A96;font-weight:700;margin-bottom:4px;font-family:'Oswald',sans-serif;letter-spacing:1px">FECHA</div><input id="adt" type="date" value="${new Date().toISOString().split('T')[0]}" style="${IS}"></div>
    <div><div style="font-size:9px;color:#5A7A96;font-weight:700;margin-bottom:4px;font-family:'Oswald',sans-serif;letter-spacing:1px">HORA</div><input id="atime" placeholder="7:00 PM" style="${IS}"></div></div>
  <div style="margin-top:8px"><div style="font-size:9px;color:#5A7A96;font-weight:700;margin-bottom:4px;font-family:'Oswald',sans-serif;letter-spacing:1px">LUGAR</div><input id="aloc" placeholder="Sala RamÃ³n Fonst" style="${IS}"></div>
  <button id="schedsave" style="margin-top:10px;background:${GD};border:none;border-radius:2px;padding:12px;color:#0B1829;font-size:13px;font-weight:700;cursor:pointer;letter-spacing:2px;font-family:'Oswald',sans-serif;width:100%">PROGRAMAR</button></div>`;
  // RECEIVE DATA
  const rcv=h("div",{style:{background:SF,border:"1px solid "+BD,borderRadius:"4px",padding:"14px 16px"}});
  rcv.appendChild(h("div",{style:{fontSize:"13px",fontWeight:"700",color:GN,letterSpacing:"2px",marginBottom:"6px",fontFamily:"'Oswald',sans-serif"}},"RECIBIR DATOS"));
  rcv.appendChild(h("div",{style:{fontSize:"10px",color:"#5A7A96",marginBottom:"8px"}},"Pega datos que te enviaron por WhatsApp"));
  const rcvRow=h("div",{style:{display:"flex",gap:"6px"}});
  const rcvInput=h("textarea",{id:"rcvdata",placeholder:"Pega texto ðŸ€TB|...",rows:"2",style:`background:#0B1829;border:1px solid ${BD};border-radius:4px;padding:8px 10px;color:#E8DFD0;font-size:10px;outline:none;width:100%;resize:none;font-family:monospace`});
  const rcvBtn=h("button",{style:{background:GN,border:"none",borderRadius:"2px",padding:"8px 14px",color:"#0B1829",fontSize:"11px",fontWeight:"700",cursor:"pointer",whiteSpace:"nowrap",fontFamily:"'Oswald',sans-serif",letterSpacing:"1px"},
    onClick:()=>{const raw=rcvInput.value?.trim();if(!raw)return alert("Pega los datos primero");
      try{let data;if(raw.includes("ðŸ€TB|")){const b64=raw.split("ðŸ€TB|")[1].trim();data=JSON.parse(decodeURIComponent(escape(atob(b64))))}else{data=JSON.parse(raw)}
        if(data.id&&data.home){const exists=S.games.find(g=>g.home===data.home&&g.away===data.away&&g.dt===data.dt);
          if(exists){if(!confirm("Ya existe. Â¿Reemplazar?"))return;DB.del(exists.id);S.games=S.games.filter(g=>g.id!==exists.id)}
          DB.set(data.id,data);S.games.unshift(data);S.games.sort((a,b)=>(b.createdAt||0)-(a.createdAt||0));
          alert("âœ… "+gt(data.away).name+" "+data.as+" â€” "+data.hs+" "+gt(data.home).name);rcvInput.value="";render()}
        else if(data.games){let added=0;data.games.forEach(g=>{if(!S.games.find(x=>x.home===g.home&&x.away===g.away&&x.dt===g.dt)){DB.set(g.id,g);S.games.push(g);added++}});
          S.games.sort((a,b)=>(b.createdAt||0)-(a.createdAt||0));alert("âœ… "+added+" juegos nuevos");rcvInput.value="";render()}
        else alert("âŒ Formato no reconocido")}catch(e){alert("âŒ Error al importar")}}},"RECIBIR");
  rcvRow.appendChild(rcvInput);rcvRow.appendChild(rcvBtn);rcv.appendChild(rcvRow);el.appendChild(rcv);
  // Stats
  el.appendChild(h("div",{style:{fontSize:"10px",color:"#3A5068",fontWeight:"700",fontFamily:"'Oswald',sans-serif",letterSpacing:"1px"}},S.games.length+" JUEGOS Â· "+S.sched.length+" PROGRAMADOS"));
  setTimeout(()=>{
    document.getElementById("schedsave")?.addEventListener("click",()=>{
      const home=document.getElementById("ah")?.value,away=document.getElementById("aa")?.value;if(!home||!away)return alert("Selecciona equipos");
      const s={id:"sched_"+Date.now(),home,away,dt:document.getElementById("adt")?.value,time:document.getElementById("atime")?.value,loc:document.getElementById("aloc")?.value,st:"sched"};
      DB.set(s.id,s);S.sched.push(s);alert("âœ… Juego programado");render()})},50);
  return el;
}

// â”€â”€â”€ ADMIN: TEAMS / ROSTER / PHOTOS / LOGOS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rAdminTeams(){
  const el=h("div",{style:{display:"flex",flexDirection:"column",gap:"10px"}});
  if(S.editTeam){// Editing a specific team
    const tid=S.editTeam;const t=gt(tid);const roster=[...(t.roster||[])];
    el.appendChild(h("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},
      h("button",{style:{background:"none",border:"none",color:"#5A7A96",fontSize:"11px",cursor:"pointer"},onClick:()=>{S.editTeam=null;render()}},"â† ATRÃS")));
    // Team name + logo section
    const logoSec=h("div",{style:{background:`linear-gradient(135deg,${t.c}15,#0F1F35)`,border:`1px solid ${t.c}44`,borderRadius:"4px",padding:"20px",textAlign:"center"}});
    logoSec.appendChild(bd(tid,100));
    logoSec.appendChild(h("div",{style:{fontSize:"22px",fontWeight:"900",color:"#E8DFD0",marginTop:"10px"}},t.name));
    logoSec.appendChild(h("div",{style:{fontSize:"11px",color:"#5A7A96"}},t.zone));
    const logoInput=h("input",{type:"file",accept:"image/*",style:"display:none",
      onChange:e=>{const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=ev=>{const img=new Image();img.onload=()=>{const c=document.createElement("canvas");c.width=200;c.height=200;const cx=c.getContext("2d");cx.drawImage(img,0,0,200,200);const data=c.toDataURL("image/jpeg",0.7);DB.set("logo_"+tid,data);render()};img.src=ev.target.result};r.readAsDataURL(f)}});
    logoSec.appendChild(h("div",{style:{display:"flex",gap:"8px",justifyContent:"center",marginTop:"12px",flexWrap:"wrap"}},
      h("button",{style:{background:AC+"22",border:"1px solid "+AC+"44",borderRadius:"4px",padding:"10px 20px",color:AC,fontSize:"11px",fontWeight:"700",cursor:"pointer"},onClick:()=>logoInput.click()},"ðŸ“· SUBIR LOGO"),
      h("button",{style:{background:"#5BB8A622",border:"1px solid #5BB8A644",borderRadius:"4px",padding:"10px 20px",color:"#5BB8A6",fontSize:"11px",fontWeight:"700",cursor:"pointer"},
        onClick:()=>{const nm=prompt("Nombre del equipo:",t.name);if(!nm||nm===t.name)return;const zone=prompt("Zona/Municipio:",t.zone||"");
          t.name=nm;if(zone)t.zone=zone;DB.set("team_"+tid,t);render()}},"âœï¸ EDITAR NOMBRE"),
      DB.get("logo_"+tid)?h("button",{style:{background:"rgba(255,59,48,.1)",border:"1px solid rgba(255,59,48,.3)",borderRadius:"4px",padding:"10px 16px",color:"#CE1126",fontSize:"11px",fontWeight:"700",cursor:"pointer"},onClick:()=>{DB.del("logo_"+tid);render()}},"ðŸ—‘ï¸ QUITAR LOGO"):null));
    logoSec.appendChild(logoInput);el.appendChild(logoSec);
    // Roster editor
    el.appendChild(h("div",{style:{fontSize:"13px",fontWeight:"800",color:AC,letterSpacing:"1px"}},"PLANTILLA ("+roster.length+" jugadores)"));
    roster.forEach((p,i)=>{
      const picKey="pic_"+p.nm.replace(/\s/g,"_")+"_"+tid;const hasPic=!!DB.get(picKey);
      el.appendChild(h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",padding:"14px",display:"flex",alignItems:"center",gap:"12px"}},
        playerPic(p.nm,tid,56),
        h("div",{style:{flex:"1"}},
          h("div",{style:{fontSize:"16px",fontWeight:"800",color:"#E8DFD0"}},"#"+p.num+" "+p.nm),
          h("div",{style:{fontSize:"11px",color:"#4A6480",marginTop:"2px"}},p.pos||"Sin posiciÃ³n"),
          h("div",{style:{display:"flex",gap:"6px",marginTop:"8px",flexWrap:"wrap"}},
            h("button",{style:{background:"rgba(100,255,218,.1)",border:"1px solid rgba(100,255,218,.3)",borderRadius:"8px",padding:"6px 12px",color:"#5BB8A6",fontSize:"9px",fontWeight:"700",cursor:"pointer"},
              onClick:()=>{const nm=prompt("Nombre:",p.nm);if(!nm)return;const num=prompt("NÃºmero:",p.num);if(!num)return;const pos=prompt("PosiciÃ³n (PG/SG/SF/PF/C):",p.pos||"");
                // Update photo key if name changed
                if(nm!==p.nm){const oldKey="pic_"+p.nm.replace(/\s/g,"_")+"_"+tid;const pic=DB.get(oldKey);if(pic){DB.set("pic_"+nm.replace(/\s/g,"_")+"_"+tid,pic);DB.del(oldKey)}}
                roster[i]={...p,nm,num,pos:pos||""};t.roster=roster;DB.set("team_"+tid,t);render()}},"âœï¸ EDITAR"),
            h("button",{style:{background:"#1A335250",border:"1px solid #1A3352aa",borderRadius:"8px",padding:"6px 12px",color:"#8BA0B4",fontSize:"9px",fontWeight:"700",cursor:"pointer"},
              onClick:()=>{const inp=document.createElement("input");inp.type="file";inp.accept="image/*";inp.onchange=e2=>{const f=e2.target.files[0];if(!f)return;
                const rd=new FileReader();rd.onload=ev=>{const img2=new Image();img2.onload=()=>{const cv=document.createElement("canvas");cv.width=150;cv.height=150;const cx2=cv.getContext("2d");
                  const sz=Math.min(img2.width,img2.height);cx2.drawImage(img2,(img2.width-sz)/2,(img2.height-sz)/2,sz,sz,0,0,150,150);
                  DB.set("pic_"+p.nm.replace(/\s/g,"_")+"_"+tid,cv.toDataURL("image/jpeg",0.6));render()};img2.src=ev.target.result};rd.readAsDataURL(f)};inp.click()}},hasPic?"ðŸ“· CAMBIAR FOTO":"ðŸ“· SUBIR FOTO"),
            hasPic?h("button",{style:{background:"rgba(255,59,48,.1)",border:"1px solid rgba(255,59,48,.3)",borderRadius:"8px",padding:"6px 10px",color:"#CE1126",fontSize:"9px",fontWeight:"700",cursor:"pointer"},
              onClick:()=>{DB.del(picKey);render()}},"ðŸ—‘ï¸"):null,
            h("button",{style:{background:"rgba(255,59,48,.1)",border:"1px solid rgba(255,59,48,.3)",borderRadius:"8px",padding:"6px 10px",color:"#CE1126",fontSize:"9px",fontWeight:"700",cursor:"pointer"},
              onClick:()=>{if(!confirm("Â¿Eliminar "+p.nm+"?"))return;roster.splice(i,1);t.roster=roster;DB.set("team_"+tid,t);render()}},"ðŸ—‘ï¸ BORRAR")))))});
    // Add player button
    el.appendChild(h("button",{style:{background:`linear-gradient(135deg,${GN}22,#0F1F35)`,border:`1px solid ${GN}44`,borderRadius:"4px",padding:"14px",color:GN,fontSize:"13px",fontWeight:"800",cursor:"pointer",textAlign:"center"},
      onClick:()=>{const nm=prompt("Nombre del jugador:");if(!nm)return;const num=prompt("NÃºmero:");if(!num)return;const pos=prompt("PosiciÃ³n (PG/SG/SF/PF/C):","");
        roster.push({nm,num,pos:pos||""});t.roster=roster;DB.set("team_"+tid,t);render()}},"âž• AGREGAR JUGADOR"));
    // SPONSOR EDITOR
    const sp=DB.get("sponsor_"+tid)||{};
    const spSec=h("div",{style:{background:SF,border:"1px solid "+GD+"33",borderRadius:"4px",padding:"14px 16px"}});
    spSec.appendChild(h("div",{style:{fontSize:"12px",fontWeight:"700",color:GD,letterSpacing:"2px",marginBottom:"8px",fontFamily:"'Oswald',sans-serif"}},"PATROCINADOR"));
    if(sp.name){
      spSec.appendChild(h("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"8px"}},
        sp.logo?h("img",{src:sp.logo,style:{width:"40px",height:"40px",borderRadius:"4px",objectFit:"cover"}}):null,
        h("div",null,h("div",{style:{fontSize:"14px",fontWeight:"700",color:"#E8DFD0"}},sp.name),
          sp.desc?h("div",{style:{fontSize:"10px",color:"#5A7A96"}},sp.desc):null)));
      spSec.appendChild(h("div",{style:{display:"flex",gap:"6px"}},
        h("button",{style:{background:GD+"22",border:"1px solid "+GD+"44",borderRadius:"4px",padding:"6px 12px",color:GD,fontSize:"9px",fontWeight:"700",cursor:"pointer"},
          onClick:()=>{const nm=prompt("Nombre del patrocinador:",sp.name);if(!nm)return;const desc=prompt("DescripciÃ³n (ej: Paladar, Bar, Tienda):",sp.desc||"");
            DB.set("sponsor_"+tid,{...sp,name:nm,desc:desc||""});render()}},"EDITAR"),
        h("button",{style:{background:"#CE112622",border:"1px solid #CE112644",borderRadius:"4px",padding:"6px 12px",color:AC,fontSize:"9px",fontWeight:"700",cursor:"pointer"},
          onClick:()=>{if(confirm("Â¿Quitar patrocinador?")){DB.del("sponsor_"+tid);render()}}},"QUITAR")))
    }else{
      spSec.appendChild(h("div",{style:{fontSize:"10px",color:"#3A5068",marginBottom:"8px"}},"AÃ±ade un negocio local como patrocinador de este equipo"));
      spSec.appendChild(h("button",{style:{background:GD,border:"none",borderRadius:"2px",padding:"10px 20px",color:"#0B1829",fontSize:"11px",fontWeight:"700",cursor:"pointer",fontFamily:"'Oswald',sans-serif",letterSpacing:"1px"},
        onClick:()=>{const nm=prompt("Nombre del patrocinador:");if(!nm)return;const desc=prompt("DescripciÃ³n (ej: Paladar, Bar, Tienda):","");
          DB.set("sponsor_"+tid,{name:nm,desc:desc||""});render()}},"AÃ‘ADIR PATROCINADOR"))}
    // Sponsor logo upload
    const spLogoInput=h("input",{type:"file",accept:"image/*",style:"display:none",
      onChange:e=>{const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=ev=>{const img=new Image();img.onload=()=>{const c=document.createElement("canvas");c.width=200;c.height=200;const cx=c.getContext("2d");cx.drawImage(img,0,0,200,200);const data=c.toDataURL("image/jpeg",0.7);const cur=DB.get("sponsor_"+tid)||{};DB.set("sponsor_"+tid,{...cur,logo:data});render()};img.src=ev.target.result};r.readAsDataURL(f)}});
    if(sp.name)spSec.appendChild(h("div",{style:{marginTop:"6px"}},
      h("button",{style:{background:"#1A335240",border:"1px solid "+BD,borderRadius:"4px",padding:"6px 12px",color:"#5A7A96",fontSize:"9px",fontWeight:"700",cursor:"pointer"},
        onClick:()=>spLogoInput.click()},sp.logo?"CAMBIAR LOGO":"SUBIR LOGO"),spLogoInput));
    el.appendChild(spSec);
    return el;
  }
  // Team list
  el.appendChild(h("div",{style:{fontSize:"14px",fontWeight:"900",color:AC,letterSpacing:"2px"}},"ðŸ‘¥ EQUIPOS"));
  el.appendChild(h("div",{style:{fontSize:"10px",color:"#5A7A96"}},"Toca un equipo para editar nombre, logo, plantilla y fotos"));
  T.forEach(t=>{
    el.appendChild(h("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"12px 14px",background:`linear-gradient(135deg,${t.c}08,#0F1F35)`,border:"1px solid #1A335260",borderRadius:"4px",marginBottom:"4px",cursor:"pointer"},
      onClick:()=>{S.editTeam=t.id;render()}},
      bd(t.id,40),
      h("div",{style:{flex:"1"}},h("div",{style:{fontSize:"13px",fontWeight:"700",color:"#E8DFD0"}},t.name),
        h("div",{style:{fontSize:"9px",color:"#3A5068"}},t.zone+" Â· "+(t.roster?.length||0)+" jugadores")),
      DB.get("logo_"+t.id)?h("span",{style:{fontSize:"8px",color:GN}},"âœ…"):null,
      h("span",{style:{fontSize:"14px",color:"#253A52"}},"â€º")))});
  return el;
}

// â”€â”€â”€ ADMIN: BRACKET EDITOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rAdminBracket(){
  const po=DB.get("playoffs")||{s1:{a:null,b:null,wa:0,wb:0},s2:{a:null,b:null,wa:0,wb:0},fin:{a:null,b:null,wa:0,wb:0},champ:null};
  const el=h("div",{style:{display:"flex",flexDirection:"column",gap:"10px"}});
  // Auto-seeding suggestion
  const rec={};T.forEach(t=>{rec[t.id]={w:0,l:0,pf:0}});S.games.forEach(g=>{if(!rec[g.home])return;const hw=g.hs>g.as;rec[g.home].w+=hw?1:0;rec[g.home].l+=hw?0:1;rec[g.away].w+=hw?0:1;rec[g.away].l+=hw?1:0});
  const sorted=T.map(t=>({...t,...rec[t.id],pct:rec[t.id].w+rec[t.id].l>0?rec[t.id].w/(rec[t.id].w+rec[t.id].l):0})).sort((a,b)=>b.pct-a.pct);
  const top4=sorted.slice(0,4);
  el.appendChild(h("div",{style:{fontSize:"14px",fontWeight:"900",color:GD,letterSpacing:"2px"}},"ðŸ† BRACKET"));
  if(top4[0]?.w)el.appendChild(h("div",{style:{fontSize:"9px",color:"#5A7A96"}},"Sugiere: #1 "+top4[0].name+" vs #4 "+(top4[3]?.name||"?")+" | #2 "+(top4[1]?.name||"?")+" vs #3 "+(top4[2]?.name||"?")));
  const mkSeries=(label,prefix,s)=>h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",padding:"12px"}},
    h("div",{style:{fontSize:"9px",fontWeight:"700",color:GD,marginBottom:"6px"}},label),
    h("div",{style:{display:"grid",gridTemplateColumns:"1fr 40px 40px 1fr",gap:"6px",alignItems:"center"}},
      h("select",{id:prefix+"a",style:IS+";cursor:pointer",innerHTML:"<option value=''>â€”</option>"+T.map(t=>"<option value='"+t.id+"'"+(s.a===t.id?" selected":"")+">"+t.name+"</option>").join("")}),
      h("input",{id:prefix+"wa",type:"number",value:String(s.wa||0),style:IS+";text-align:center;font-weight:900;font-size:16px",min:"0"}),
      h("input",{id:prefix+"wb",type:"number",value:String(s.wb||0),style:IS+";text-align:center;font-weight:900;font-size:16px",min:"0"}),
      h("select",{id:prefix+"b",style:IS+";cursor:pointer",innerHTML:"<option value=''>â€”</option>"+T.map(t=>"<option value='"+t.id+"'"+(s.b===t.id?" selected":"")+">"+t.name+"</option>").join("")})));
  el.appendChild(mkSeries("SEMIFINAL 1","s1",po.s1));
  el.appendChild(mkSeries("SEMIFINAL 2","s2",po.s2));
  el.appendChild(mkSeries("FINAL","f",po.fin));
  // Champion
  el.appendChild(h("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"}},
    h("div",null,h("div",{style:{fontSize:"9px",fontWeight:"700",color:GD,marginBottom:"4px"}},"ðŸ† CAMPEÃ“N"),
      h("select",{id:"champ",style:IS+";cursor:pointer",innerHTML:"<option value=''>â€”</option>"+T.map(t=>"<option value='"+t.id+"'"+(po.champ===t.id?" selected":"")+">"+t.name+"</option>").join("")})),
    h("button",{style:{alignSelf:"end",background:AC,border:"none",borderRadius:"4px",padding:"12px",color:"#E8DFD0",fontSize:"12px",fontWeight:"800",cursor:"pointer"},
      onClick:()=>{const np={s1:{a:document.getElementById("s1a")?.value||null,b:document.getElementById("s1b")?.value||null,wa:parseInt(document.getElementById("s1wa")?.value)||0,wb:parseInt(document.getElementById("s1wb")?.value)||0},
        s2:{a:document.getElementById("s2a")?.value||null,b:document.getElementById("s2b")?.value||null,wa:parseInt(document.getElementById("s2wa")?.value)||0,wb:parseInt(document.getElementById("s2wb")?.value)||0},
        fin:{a:document.getElementById("fa")?.value||null,b:document.getElementById("fb")?.value||null,wa:parseInt(document.getElementById("fwa")?.value)||0,wb:parseInt(document.getElementById("fwb")?.value)||0},
        champ:document.getElementById("champ")?.value||null};
        DB.set("playoffs",np);alert("âœ… Bracket guardado");render()}},"ðŸ’¾ GUARDAR")));
  return el;
}

// â”€â”€â”€ ADMIN: TOOLS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rAdminTools(){
  const el=h("div",{style:{display:"flex",flexDirection:"column",gap:"10px"}});
  // â”€â”€ ANALYTICS DASHBOARD â”€â”€
  const visits=DB.get("analytics")||{total:0,daily:{},first:null,sessions:[],last:null};
  const today=new Date().toISOString().split("T")[0];
  const todayCount=visits.daily[today]||0;
  const uniqueDays=visits.sessions?.length||0;
  const totalUsers=DB.all("user_").length;
  // Last 7 days
  const last7=[];for(let i=6;i>=0;i--){const d=new Date();d.setDate(d.getDate()-i);const k=d.toISOString().split("T")[0];last7.push({dt:k,day:d.toLocaleDateString("es",{weekday:"short"}).slice(0,2),count:visits.daily[k]||0})}
  const maxDay=Math.max(...last7.map(d=>d.count),1);
  const anEl=h("div",{style:{background:`linear-gradient(135deg,${GD}08,${SF})`,border:`1px solid ${GD}33`,borderRadius:"4px",padding:"14px 16px"}});
  anEl.appendChild(h("div",{style:{fontSize:"12px",fontWeight:"700",color:GD,letterSpacing:"2px",marginBottom:"10px",fontFamily:"'Oswald',sans-serif"}},"ANALYTICS"));
  // Stats row
  anEl.appendChild(h("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gap:"6px",marginBottom:"12px"}},
    ...[["HOY",todayCount,AC],["TOTAL",visits.total,"#E8DFD0"],["DÃAS",uniqueDays,GD],["PERFILES",totalUsers,GN]].map(([l,v,c])=>
      h("div",{style:{textAlign:"center",background:"#0B182980",borderRadius:"4px",padding:"8px 4px"}},
        h("div",{style:{fontSize:"18px",fontWeight:"700",color:c,fontFamily:"'Oswald',sans-serif"}},String(v)),
        h("div",{style:{fontSize:"7px",color:"#3A5068",letterSpacing:"1px"}},l)))));
  // Bar chart â€” last 7 days
  anEl.appendChild(h("div",{style:{fontSize:"9px",color:"#3A5068",marginBottom:"6px",fontFamily:"'Oswald',sans-serif",letterSpacing:"1px"}},"ÃšLTIMOS 7 DÃAS"));
  const chart=h("div",{style:{display:"flex",alignItems:"flex-end",gap:"4px",height:"50px"}});
  last7.forEach(d=>{const pct=d.count/maxDay*100;
    chart.appendChild(h("div",{style:{flex:"1",display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"}},
      h("div",{style:{fontSize:"8px",color:d.count?"#E8DFD0":"#2E4560",fontWeight:"700"}},d.count||""),
      h("div",{style:{width:"100%",height:Math.max(pct,4)+"%",background:d.dt===today?AC:GD+"66",borderRadius:"2px 2px 0 0",minHeight:"2px"}}),
      h("div",{style:{fontSize:"7px",color:"#3A5068",marginTop:"2px"}},d.day)))});
  anEl.appendChild(chart);
  // GoatCounter link
  anEl.appendChild(h("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"10px",paddingTop:"8px",borderTop:"1px solid "+BD}},
    h("div",{style:{fontSize:"9px",color:"#3A5068"}},"Tracking local "+(visits.first?"desde "+visits.first:"")),
    h("a",{href:"https://tabloncillo.goatcounter.com",target:"_blank",style:{fontSize:"9px",color:GD,textDecoration:"none",fontWeight:"700"}},"Ver GoatCounter â†’")));
  el.appendChild(anEl);
  // Calculate storage usage
  let totalSize=0;let logoCount=0;let picCount=0;
  for(let i=0;i<localStorage.length;i++){const k=localStorage.key(i);const v=localStorage.getItem(k);totalSize+=k.length+v.length;
    if(k.startsWith("logo_"))logoCount++;if(k.startsWith("pic_"))picCount++}
  const sizeMB=(totalSize*2/1024/1024).toFixed(2);// UTF-16

  el.innerHTML=`<div style="font-size:14px;font-weight:900;color:${AC};letter-spacing:2px">ðŸ”§ HERRAMIENTAS</div>
  <div style="background:linear-gradient(135deg,${GN}12,#0F1F35);border:1px solid ${GN}33;border-radius:4px;padding:14px 16px">
    <div style="font-size:11px;font-weight:800;color:${GN};letter-spacing:1px;margin-bottom:8px">ðŸ’¾ RESPALDO COMPLETO</div>
    <div style="font-size:10px;color:#888;margin-bottom:4px">Exporta TODO: juegos, equipos, logos, fotos, bracket, archivo</div>
    <div style="font-size:9px;color:#555;margin-bottom:10px">ðŸ“¦ ${S.games.length} juegos Â· ${logoCount} logos Â· ${picCount} fotos Â· ${sizeMB}MB usado</div>
    <div style="display:flex;gap:8px">
      <button id="fullexp" style="flex:1;background:${GN};border:none;border-radius:4px;padding:12px;color:#fff;font-size:12px;font-weight:800;cursor:pointer">ðŸ“¥ EXPORTAR TODO</button>
      <button id="fullimp" style="flex:1;background:${AC};border:none;border-radius:4px;padding:12px;color:#fff;font-size:12px;font-weight:800;cursor:pointer">ðŸ“¤ IMPORTAR TODO</button>
      <input id="fullfile" type="file" accept=".json,.tabloncillo" style="display:none"></div>
    <div style="font-size:8px;color:#555;margin-top:6px;text-align:center">El archivo incluye imÃ¡genes â€” puede pesar varios MB</div>
  </div>
  <div style="background:#0F1F35;border:1px solid #1A335260;border-radius:4px;padding:14px 16px">
    <div style="font-size:11px;font-weight:800;color:#888;letter-spacing:1px;margin-bottom:8px">âš¡ EXPORTACIÃ“N LIGERA</div>
    <div style="font-size:10px;color:#555;margin-bottom:8px">Solo juegos y calendario (sin imÃ¡genes) â€” para WhatsApp</div>
    <div style="display:flex;gap:8px">
      <button id="aexp" style="flex:1;background:#1A335240;border:1px solid #1A335280;border-radius:8px;padding:10px;color:#aaa;font-size:10px;font-weight:700;cursor:pointer">ðŸ“¥ EXPORTAR JUEGOS</button>
      <button id="aimp" style="flex:1;background:#1A335240;border:1px solid #1A335280;border-radius:8px;padding:10px;color:#aaa;font-size:10px;font-weight:700;cursor:pointer">ðŸ“¤ IMPORTAR JUEGOS</button>
      <input id="afile" type="file" accept=".json" style="display:none"></div>
  </div>
  <div style="display:flex;gap:8px">
    <button id="goarchive" style="flex:1;background:#1A335240;border:1px solid #1A335280;border-radius:8px;padding:10px;color:#aaa;font-size:10px;font-weight:700;cursor:pointer">ðŸ“¦ TEMPORADAS</button>
    <button id="goleaders" style="flex:1;background:#1A335240;border:1px solid #1A335280;border-radius:8px;padding:10px;color:#aaa;font-size:10px;font-weight:700;cursor:pointer">ðŸ“ˆ LÃDERES</button></div>
  <div style="background:#1A335230;border:1px solid #1A335260;border-radius:4px;padding:12px">
    <div style="font-size:10px;font-weight:800;color:#888;letter-spacing:1px;margin-bottom:6px">ðŸ”‘ PINES DE ACCESO</div>
    <div style="display:flex;gap:12px;font-size:11px">
      <div><span style="color:${AC}">Admin:</span> <span style="color:#fff;font-weight:700">${ADMIN_PIN}</span></div>
      <div><span style="color:${GN}">Reporter:</span> <span style="color:#fff;font-weight:700">${REP_PIN}</span></div></div>
    <div style="font-size:9px;color:#555;margin-top:4px">Comparte el PIN de reporter con los que van a las canchas</div></div>
  <button id="nukebtn" style="background:rgba(255,59,48,.08);border:1px solid rgba(255,59,48,.2);border-radius:8px;padding:10px;color:#CE1126;font-size:9px;font-weight:700;cursor:pointer">âš ï¸ BORRAR TODOS LOS DATOS</button>`;
  setTimeout(()=>{
    // FULL EXPORT â€” everything
    document.getElementById("fullexp")?.addEventListener("click",()=>{
      const bundle={v:"v21",exportDate:new Date().toISOString(),games:S.games,schedule:S.sched,
        playoffs:DB.get("playoffs"),teams:{},logos:{},photos:{},sponsors:{},seasons:[],allstar:DB.get("allstar_votes"),analytics:DB.get("analytics")};
      // Collect team customizations
      T.forEach(t=>{const saved=DB.get("team_"+t.id);if(saved)bundle.teams[t.id]=saved});
      // Collect logos
      T.forEach(t=>{const logo=DB.get("logo_"+t.id);if(logo)bundle.logos[t.id]=logo});
      // Collect sponsors
      T.forEach(t=>{const sp=DB.get("sponsor_"+t.id);if(sp)bundle.sponsors[t.id]=sp});
      // Collect player photos
      for(let i=0;i<localStorage.length;i++){const k=localStorage.key(i);
        if(k.startsWith("pic_")){const v=DB.get(k);if(v)bundle.photos[k]=v}}
      // Collect season archives
      bundle.seasons=DB.all("season_");
      // User profiles
      bundle.users=DB.all("user_");
      const json=JSON.stringify(bundle);const sizeMB2=(json.length/1024/1024).toFixed(1);
      const blob=new Blob([json],{type:"application/json"});const url=URL.createObjectURL(blob);
      const a=document.createElement("a");a.href=url;
      a.download="tabloncillo-backup-"+new Date().toISOString().split("T")[0]+".json";a.click();
      alert("âœ… Respaldo completo exportado ("+sizeMB2+"MB)\\n"+S.games.length+" juegos, "+Object.keys(bundle.logos).length+" logos, "+Object.keys(bundle.photos).length+" fotos")});
    // FULL IMPORT â€” everything
    document.getElementById("fullimp")?.addEventListener("click",()=>document.getElementById("fullfile")?.click());
    document.getElementById("fullfile")?.addEventListener("change",async e=>{
      const f=e.target.files[0];if(!f)return;
      const statusEl=document.getElementById("impstatus");
      try{const txt=await f.text();const d=JSON.parse(txt);
        if(!d.v||!d.games){alert("âŒ No parece un respaldo de Tabloncillo");return}
        if(!confirm("âš ï¸ Esto reemplazarÃ¡ TODOS los datos actuales con el respaldo.\\n\\n"+
          "El archivo contiene:\\n"+
          "â€¢ "+(d.games?.length||0)+" juegos\\n"+
          "â€¢ "+(Object.keys(d.logos||{}).length)+" logos\\n"+
          "â€¢ "+(Object.keys(d.photos||{}).length)+" fotos\\n"+
          "â€¢ "+(d.seasons?.length||0)+" temporadas archivadas\\n\\n"+
          "Â¿Continuar?"))return;
        // Clear existing game/sched data
        S.games.forEach(g=>DB.del(g.id));S.sched.forEach(s=>DB.del(s.id));
        // Import games
        let gc=0;(d.games||[]).forEach(g=>{DB.set(g.id,g);gc++});
        // Import schedule
        let sc=0;(d.schedule||[]).forEach(s=>{DB.set(s.id,s);sc++});
        // Import team customizations
        if(d.teams){Object.entries(d.teams).forEach(([tid,data])=>{
          DB.set("team_"+tid,data);const t=T.find(x=>x.id===tid);
          if(t){if(data.name)t.name=data.name;if(data.zone)t.zone=data.zone;if(data.roster)t.roster=data.roster}})}
        // Import logos
        let lc=0;if(d.logos){Object.entries(d.logos).forEach(([tid,data])=>{DB.set("logo_"+tid,data);lc++})}
        // Import photos
        let pc=0;if(d.photos){Object.entries(d.photos).forEach(([key,data])=>{
          const k=key.startsWith("pic_")?key:key;DB.set(k,data);pc++})}
        // Import playoffs
        if(d.playoffs)DB.set("playoffs",d.playoffs);
        // Import sponsors
        if(d.sponsors){Object.entries(d.sponsors).forEach(([tid,data])=>{DB.set("sponsor_"+tid,data)})}
        // Import seasons
        let sec2=0;if(d.seasons){d.seasons.forEach(s=>{DB.set(s.id,s);sec2++})}
        // Import users
        if(d.users){d.users.forEach(u=>{if(u.id)DB.set(u.id,u)})}
        // Import allstar
        if(d.allstar)DB.set("allstar_votes",d.allstar);
        if(d.analytics){const cur=DB.get("analytics")||{total:0,daily:{},sessions:[]};cur.total+=d.analytics.total||0;Object.entries(d.analytics.daily||{}).forEach(([k,v])=>{cur.daily[k]=(cur.daily[k]||0)+v});DB.set("analytics",cur)}
        // Reload state
        S.games=DB.all("game_").sort((a,b)=>(b.createdAt||0)-(a.createdAt||0));
        S.sched=DB.all("sched_");
        alert("âœ… Respaldo restaurado!\\n"+gc+" juegos, "+lc+" logos, "+pc+" fotos, "+sec2+" temporadas");
        render();
      }catch(err){alert("âŒ Error al importar: "+err.message)}});
    // Light export (games only)
    document.getElementById("aexp")?.addEventListener("click",()=>{const d=JSON.stringify({games:S.games,schedule:S.sched,v:"v18"});const b=new Blob([d],{type:"application/json"});const u=URL.createObjectURL(b);const a=document.createElement("a");a.href=u;a.download="tabloncillo-juegos.json";a.click()});
    // Light import (games only)
    document.getElementById("aimp")?.addEventListener("click",()=>document.getElementById("afile")?.click());
    document.getElementById("afile")?.addEventListener("change",async e=>{const f=e.target.files[0];if(!f)return;try{const t=await f.text();const d=JSON.parse(t);let c=0;if(d.games){d.games.forEach(g=>{if(!S.games.find(x=>x.home===g.home&&x.away===g.away&&x.dt===g.dt)){DB.set(g.id,g);c++}})}alert("âœ… "+c+" juegos nuevos");S.games=DB.all("game_").sort((a,b)=>(b.createdAt||0)-(a.createdAt||0));render()}catch{alert("âŒ Error")}});
    // Other buttons
    document.getElementById("goarchive")?.addEventListener("click",()=>{S.tab="archive";render()});
    document.getElementById("goleaders")?.addEventListener("click",()=>{S.tab="leaders";render()});
    // Nuke
    document.getElementById("nukebtn")?.addEventListener("click",()=>{
      if(!confirm("âš ï¸ Â¿EstÃ¡s SEGURO? Esto borrarÃ¡ TODOS los datos de Tabloncillo."))return;
      if(!confirm("ðŸ”´ ÃšLTIMA OPORTUNIDAD. Esto es irreversible. Â¿Continuar?"))return;
      const prefixes=["game_","sched_","team_","logo_","pic_","playoffs","season_","user_","my_profile","allstar_","sponsor_","analytics","pick_","ios_hint"];
      for(let i=localStorage.length-1;i>=0;i--){const k=localStorage.key(i);if(prefixes.some(p=>k.startsWith(p)))localStorage.removeItem(k)}
      location.reload()});
  },50);
  return el;
}

// â”€â”€â”€ PLAYER PROFILE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rPlayer(){
  const[nm,tm]=S.pp.split("|||");const t=gt(tm);
  const pg=[];S.games.forEach(g=>{g.ps?.forEach(p=>{if(p.nm===nm&&p.tm===tm)pg.push({...p,dt:g.dt,opp:g.home===tm?g.away:g.home,w:(g.home===tm&&g.hs>g.as)||(g.away===tm&&g.as>g.hs),loc:g.loc,gs:g.home===tm?g.hs:g.as,ga:g.home===tm?g.as:g.hs})})});
  if(!pg.length)return h("div",{style:{textAlign:"center",padding:"40px",color:"#3A5068"}},"Sin datos");
  const avg=(k)=>(pg.reduce((s,p)=>s+p[k],0)/pg.length).toFixed(1);
  const best=pg.reduce((b,p)=>p.pts>b.pts?p:b,pg[0]);
  const el=h("div",{style:{display:"flex",flexDirection:"column",gap:"12px"}});
  el.appendChild(h("button",{style:{background:"none",border:"none",color:"#5A7A96",fontSize:"11px",fontWeight:"700",cursor:"pointer",textAlign:"left"},onClick:()=>{S.pp=null;render()}},"â† VOLVER"));
  // Header
  el.appendChild(h("div",{style:{background:`linear-gradient(135deg,${t.c}22,#0F1F35)`,border:`1px solid ${t.c}44`,borderRadius:"4px",padding:"16px"}},
    h("div",{style:{display:"flex",alignItems:"center",gap:"12px"}},
      h("div",{style:{width:"52px",height:"52px",borderRadius:"4px",background:t.c,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",fontWeight:"900",color:t.a}},"#"+(pg[0].num||"0")),
      h("div",{style:{flex:"1"}},h("div",{style:{fontSize:"22px",fontWeight:"900"}},nm),h("div",{style:{fontSize:"12px",color:"#5A7A96"}},t.name+" Â· "+t.zone)),
      h("div",{style:{textAlign:"center"}},h("div",{style:{fontSize:"28px",fontWeight:"900",color:AC}},avg("pts")),h("div",{style:{fontSize:"8px",color:"#3A5068",letterSpacing:"1px"}},"PPJ")))));
  // Season averages
  const grid=h("div",{style:{display:"grid",gridTemplateColumns:"repeat(5,1fr)",gap:"6px"}});
  [["PTS",avg("pts"),AC],["REB",avg("reb"),"#C9A84C"],["AST",avg("ast"),"#5BB8A6"],["ROB",avg("stl"),GD],["BLQ",avg("blk"),"#D44040"]].forEach(([l,v,c])=>
    grid.appendChild(h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",padding:"10px 4px",textAlign:"center"}},
      h("div",{style:{fontSize:"18px",fontWeight:"900",color:c}},v),h("div",{style:{fontSize:"7px",color:"#3A5068",letterSpacing:"1px",fontWeight:"700"}},l))));
  el.appendChild(grid);
  // Career high
  el.appendChild(h("div",{style:{background:`linear-gradient(135deg,${AC}12,#0F1F35)`,border:`1px solid ${AC}22`,borderRadius:"4px",padding:"12px 16px",display:"flex",alignItems:"center",gap:"10px"}},
    h("div",{style:{fontSize:"28px"}},"ðŸ”¥"),
    h("div",{style:{flex:"1"}},h("div",{style:{fontSize:"10px",color:"#5A7A96"}},best.dt+" vs "+gt(best.opp).name),h("div",{style:{fontSize:"11px",color:"#9CB0C4"}},best.pts+"pts Â· "+best.reb+"reb Â· "+best.ast+"ast")),
    h("div",{style:{textAlign:"right"}},h("div",{style:{fontSize:"22px",fontWeight:"900",color:AC}},String(best.pts)),h("div",{style:{fontSize:"7px",color:"#3A5068"}},"MEJOR"))));
  // Shooting
  const fgm=pg.reduce((s,p)=>s+p.fgm,0),fga=pg.reduce((s,p)=>s+p.fga,0);
  if(fga>0){const fg=Math.round(fgm/fga*100);
    el.appendChild(h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",padding:"14px 16px"}},
      h("div",{style:{fontSize:"11px",fontWeight:"800",letterSpacing:"1px",marginBottom:"8px"}},"TIRO DE CAMPO"),
      h("div",{style:{display:"flex",alignItems:"center",gap:"12px"}},
        h("div",{style:{fontSize:"32px",fontWeight:"900",color:fg>=50?GN:fg>=40?"#888":"#D44040"}},fg+"%"),
        h("div",{style:{flex:"1",height:"8px",borderRadius:"4px",background:"#1A335260",overflow:"hidden"}},
          h("div",{style:{width:fg+"%",height:"100%",borderRadius:"4px",background:fg>=50?GN:fg>=40?GD:"#D44040"}})),
        h("div",{style:{fontSize:"10px",color:"#3A5068"}},fgm+"/"+fga))))}
  // Game log
  const gl=h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",overflow:"hidden"}});
  gl.appendChild(h("div",{style:{padding:"10px 16px",borderBottom:"1px solid #1A335260"}},h("span",{style:{fontSize:"11px",fontWeight:"800",letterSpacing:"1px"}},"JUEGO POR JUEGO ("+pg.length+")")));
  const tbl=h("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"9px"}});
  const hdr=h("tr");["FECHA","VS","RES","PTS","REB","AST","ROB","BLQ","TC%"].forEach((x,i)=>hdr.appendChild(h("th",{style:{padding:"4px 5px",textAlign:i>2?"center":"left",color:"#3A5068",fontWeight:"700",fontSize:"7px",borderBottom:"1px solid #1A335240"}},x)));tbl.appendChild(hdr);
  pg.forEach(p=>{const fg=p.fga>0?Math.round(p.fgm/p.fga*100):0;
    tbl.appendChild(h("tr",{style:{borderBottom:"1px solid #1A335222"}},
      h("td",{style:{padding:"4px 5px",color:"#4A6480",fontSize:"8px"}},p.dt),
      h("td",{style:{padding:"4px 5px"}},h("div",{style:{display:"flex",alignItems:"center",gap:"4px"}},bd(p.opp,14),h("span",{style:{color:"#8BA0B4",fontSize:"9px"}},gt(p.opp).name))),
      h("td",{style:{padding:"4px 5px",fontWeight:"700",color:p.w?GN:"#D44040"}},p.w?"V":"D"),
      h("td",{style:{textAlign:"center",color:p.pts>=20?AC:"#aaa",fontWeight:"700"}},String(p.pts)),h("td",{style:{textAlign:"center",color:"#C9A84C"}},String(p.reb)),
      h("td",{style:{textAlign:"center",color:"#5BB8A6"}},String(p.ast)),h("td",{style:{textAlign:"center",color:GD}},String(p.stl)),h("td",{style:{textAlign:"center",color:"#D44040"}},String(p.blk)),
      h("td",{style:{textAlign:"center",color:fg>=50?GN:"#888"}},fg+"%")))});
  gl.appendChild(h("div",{style:{overflowX:"auto"}},tbl));el.appendChild(gl);
  return el;
}

// â”€â”€â”€ PLAYOFF BRACKET â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rPlayoffs(){
  const po=DB.get("playoffs")||{s1:{a:null,b:null,wa:0,wb:0},s2:{a:null,b:null,wa:0,wb:0},fin:{a:null,b:null,wa:0,wb:0},champ:null};
  const el=h("div",{style:{display:"flex",flexDirection:"column",gap:"12px"}});
  el.appendChild(h("div",{style:{fontSize:"16px",fontWeight:"900",letterSpacing:"2px"}},"ðŸ† PLAYOFFS"));
  const rec={};T.forEach(t=>{rec[t.id]={w:0,l:0,pf:0}});S.games.forEach(g=>{if(!rec[g.home])return;const hw=g.hs>g.as;rec[g.home].w+=hw?1:0;rec[g.home].l+=hw?0:1;rec[g.away].w+=hw?0:1;rec[g.away].l+=hw?1:0});
  const sorted=T.map(t=>({...t,...rec[t.id],pct:rec[t.id].w+rec[t.id].l>0?rec[t.id].w/(rec[t.id].w+rec[t.id].l):0})).sort((a,b)=>b.pct-a.pct);
  if(S.admin)el.appendChild(h("button",{style:{background:AC+"22",border:"1px solid "+AC+"44",borderRadius:"8px",padding:"8px",color:AC,fontSize:"10px",fontWeight:"700",cursor:"pointer"},onClick:()=>{S.adminTab="bracket";S.tab="admin";render()}},"ðŸ”§ Editar bracket en Admin"));
  const mkSlot=(tid,wins,isWinner)=>{if(!tid)return h("div",{style:{padding:"8px 10px",background:"#1A335230",border:"1px solid #1A335260",borderRadius:"8px",fontSize:"10px",color:"#2E4560"}},"Por definir");
    const t=gt(tid);return h("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 10px",background:isWinner?t.c+"22":"#1A335230",border:isWinner?"2px solid "+t.c:"1px solid #1A335280",borderRadius:"8px",cursor:"pointer"},onClick:()=>{S.tp=tid;S.tab="team";render()}},
      bd(tid,20),h("div",{style:{flex:"1"}},h("div",{style:{fontSize:"11px",fontWeight:isWinner?"800":"600",color:isWinner?"#fff":"#aaa"}},t.name)),
      h("span",{style:{fontSize:"18px",fontWeight:"900",color:isWinner?GN:"#555"}},String(wins)))};
  const bracket=h("div",{style:{display:"flex",flexDirection:"column",gap:"12px"}});
  [["SEMIFINAL 1",po.s1],["SEMIFINAL 2",po.s2]].forEach(([label,s])=>{
    const sec=h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",padding:"12px 14px"}});
    sec.appendChild(h("div",{style:{fontSize:"9px",fontWeight:"800",color:GD,letterSpacing:"1px",marginBottom:"8px"}},label));
    sec.appendChild(mkSlot(s.a,s.wa,s.wa>s.wb));sec.appendChild(h("div",{style:{textAlign:"center",fontSize:"9px",color:"#253A52",margin:"4px 0"}},"vs"));
    sec.appendChild(mkSlot(s.b,s.wb,s.wb>s.wa));bracket.appendChild(sec)});
  const fin=h("div",{style:{background:`linear-gradient(135deg,${GD}12,#0F1F35)`,border:`1px solid ${GD}33`,borderRadius:"4px",padding:"12px 14px"}});
  fin.appendChild(h("div",{style:{fontSize:"11px",fontWeight:"800",color:GD,letterSpacing:"1px",marginBottom:"8px"}},"ðŸ† FINAL"));
  fin.appendChild(mkSlot(po.fin.a,po.fin.wa,po.fin.wa>po.fin.wb));fin.appendChild(h("div",{style:{textAlign:"center",fontSize:"9px",color:"#253A52",margin:"4px 0"}},"vs"));
  fin.appendChild(mkSlot(po.fin.b,po.fin.wb,po.fin.wb>po.fin.wa));bracket.appendChild(fin);
  if(po.champ){const ct=gt(po.champ);bracket.appendChild(h("div",{style:{background:`linear-gradient(135deg,${GD}22,${ct.c}22)`,border:`2px solid ${GD}`,borderRadius:"4px",padding:"16px",textAlign:"center"}},
    h("div",{style:{fontSize:"24px",marginBottom:"4px"}},"ðŸ†"),bd(po.champ,40),
    h("div",{style:{fontSize:"20px",fontWeight:"900",color:GD,marginTop:"6px"}},ct.name),
    h("div",{style:{fontSize:"11px",color:"#5A7A96"}},"CAMPEÃ“N DE LA HABANA")))}
  el.appendChild(bracket);
  el.appendChild(h("div",{style:{fontSize:"11px",fontWeight:"800",letterSpacing:"1px",marginTop:"8px"}},"CLASIFICACIÃ“N"));
  sorted.slice(0,8).forEach((t,i)=>{const quali=i<4;
    el.appendChild(h("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 12px",background:quali?"rgba(255,107,53,.03)":"#0F1F35",border:"1px solid "+(quali?AC+"22":"#1A335240"),borderRadius:"8px",marginBottom:"3px",cursor:"pointer"},onClick:()=>{S.tp=t.id;S.tab="team";render()}},
      h("span",{style:{fontSize:"12px",fontWeight:"900",color:quali?GD:"#555",width:"16px"}},String(i+1)),bd(t.id,18),
      h("span",{style:{fontSize:"11px",fontWeight:quali?"700":"500",color:quali?"#fff":"#888",flex:"1"}},t.name),
      h("span",{style:{fontSize:"11px",fontWeight:"900",color:GN}},String(t.w)),h("span",{style:{color:"#3A5068"}},"-"),h("span",{style:{color:"#5A7A96"}},String(t.l)),
      quali?h("span",{style:{fontSize:"8px",color:AC,fontWeight:"700",marginLeft:"4px"}},"âœ“"):null))});
  return el;
}

// â”€â”€â”€ ALL-STAR VOTING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rAllStar(){
  const el=h("div",{style:{display:"flex",flexDirection:"column",gap:"12px"}});
  el.appendChild(h("div",{style:{fontSize:"16px",fontWeight:"900",letterSpacing:"2px"}},"â­ ALL-STAR HABANA"));
  el.appendChild(h("div",{style:{fontSize:"10px",color:"#5A7A96"}},"Vota por los 5 mejores jugadores de la liga"));
  // Get all players
  const allP={};S.games.forEach(g=>{g.ps?.forEach(p=>{const k=p.nm+"|||"+p.tm;if(!allP[k])allP[k]={nm:p.nm,tm:p.tm,num:p.num,gp:0,pts:0,reb:0,ast:0};allP[k].gp++;allP[k].pts+=p.pts;allP[k].reb+=p.reb;allP[k].ast+=p.ast})});
  const players=Object.values(allP).sort((a,b)=>(b.pts/b.gp)-(a.pts/a.gp));
  const myVotes=S.allstar?.picks||[];
  // All votes from all users
  const allVotes={};DB.all("asvote_").forEach(v=>{(v.picks||[]).forEach(pk=>{allVotes[pk]=(allVotes[pk]||0)+1})});
  // Results sorted by votes
  const results=players.map(p=>({...p,key:p.nm+"|||"+p.tm,votes:allVotes[p.nm+"|||"+p.tm]||0})).sort((a,b)=>b.votes-a.votes);
  const totalVoters=DB.all("asvote_").length;

  if(!S.user){el.appendChild(h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",padding:"16px",textAlign:"center"}},
    h("div",{style:{fontSize:"11px",color:"#5A7A96"}},"RegÃ­strate en ðŸ‘¤ PERFIL para votar")));
  }else{
    el.appendChild(h("div",{style:{fontSize:"10px",color:myVotes.length>=5?GN:"#888"}},myVotes.length>=5?"âœ… Ya votaste por 5 jugadores":"Selecciona "+String(5-myVotes.length)+" mÃ¡s"));
    players.forEach(p=>{const key=p.nm+"|||"+p.tm;const t=gt(p.tm);const voted=myVotes.includes(key);const votes=allVotes[key]||0;
      el.appendChild(h("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px 14px",background:voted?t.c+"22":"#0F1F35",border:voted?"2px solid "+t.c:"1px solid #1A335260",borderRadius:"4px",marginBottom:"4px",cursor:myVotes.length<5||voted?"pointer":"default",opacity:myVotes.length>=5&&!voted?".4":"1"},
        onClick:()=>{if(!S.allstar)S.allstar={picks:[]};
          if(voted){S.allstar.picks=S.allstar.picks.filter(x=>x!==key)}
          else if(S.allstar.picks.length<5){S.allstar.picks.push(key)}
          else return;
          DB.set("allstar_votes",S.allstar);DB.set("asvote_"+S.user.name.replace(/\s/g,"_"),{name:S.user.name,picks:S.allstar.picks});render()}},
        voted?h("span",{style:{fontSize:"16px"}},"â­"):h("span",{style:{width:"16px"}}),
        bd(p.tm,22),h("div",{style:{flex:"1"}},h("div",{style:{fontSize:"12px",fontWeight:voted?"800":"600",color:voted?"#fff":"#ccc"}},p.nm),h("div",{style:{fontSize:"9px",color:"#3A5068"}},t.name+" Â· "+(p.pts/p.gp).toFixed(1)+"ppj")),
        votes>0?h("div",{style:{textAlign:"right"}},h("div",{style:{fontSize:"14px",fontWeight:"900",color:GD}},String(votes)),h("div",{style:{fontSize:"7px",color:"#3A5068"}},"VOTOS")):null))})};
  // Results
  if(totalVoters>0){
    el.appendChild(h("div",{style:{fontSize:"12px",fontWeight:"800",letterSpacing:"1px",marginTop:"12px"}},"ðŸ† RESULTADOS ("+totalVoters+" votantes)"));
    const top5=results.slice(0,5);
    const rSec=h("div",{style:{background:`linear-gradient(135deg,${GD}12,#0F1F35)`,border:`1px solid ${GD}33`,borderRadius:"4px",overflow:"hidden"}});
    rSec.appendChild(h("div",{style:{padding:"10px 16px",borderBottom:"1px solid #1A335260"}},h("span",{style:{fontSize:"11px",fontWeight:"800",color:GD,letterSpacing:"1px"}},"â­ ALL-STAR FIVE")));
    top5.forEach((p,i)=>{const t=gt(p.tm);rSec.appendChild(h("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 16px",borderBottom:"1px solid #1A335222"}},
      h("span",{style:{fontSize:"16px",fontWeight:"900",color:i<3?GD:"#888",width:"20px"}},String(i+1)),bd(p.tm,24),
      h("div",{style:{flex:"1"}},h("div",{style:{fontSize:"13px",fontWeight:"800",color:"#E8DFD0"}},p.nm),h("div",{style:{fontSize:"9px",color:"#3A5068"}},t.name+" Â· "+(p.pts/p.gp).toFixed(1)+"ppj")),
      h("div",{style:{textAlign:"right"}},h("div",{style:{fontSize:"16px",fontWeight:"900",color:GD}},String(p.votes)),h("div",{style:{fontSize:"7px",color:"#3A5068"}},"VOTOS"))))});
    el.appendChild(rSec)}
  return el;
}

// â”€â”€â”€ SOCIAL MEDIA CARD GENERATOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function genSocialCard(g){
  const cvs=document.createElement("canvas");cvs.width=1080;cvs.height=1350;
  const cx=cvs.getContext("2d");const at=gt(g.away),ht=gt(g.home);
  const hw=g.hs>g.as;const topA=(g.ps||[]).filter(p=>p.tm===g.away).sort((a,b)=>b.pts-a.pts)[0];
  const topH=(g.ps||[]).filter(p=>p.tm===g.home).sort((a,b)=>b.pts-a.pts)[0];
  // Background
  const bg=cx.createLinearGradient(0,0,1080,1350);bg.addColorStop(0,"#0B1829");bg.addColorStop(0.5,"#0F1F35");bg.addColorStop(1,"#0B1829");
  cx.fillStyle=bg;cx.fillRect(0,0,1080,1350);
  // Team color bars
  cx.fillStyle=at.c+"44";cx.fillRect(0,0,540,1350);cx.fillStyle=ht.c+"44";cx.fillRect(540,0,540,1350);
  // Center gradient overlay
  const cg=cx.createLinearGradient(400,0,680,0);cg.addColorStop(0,"transparent");cg.addColorStop(0.5,"#0B1829");cg.addColorStop(1,"transparent");
  cx.fillStyle=cg;cx.fillRect(400,0,280,1350);
  // Top accent bar
  const tg=cx.createLinearGradient(0,0,1080,0);tg.addColorStop(0,AC);tg.addColorStop(0.5,GD);tg.addColorStop(1,GN);
  cx.fillStyle=tg;cx.fillRect(0,0,1080,6);
  // Header
  cx.fillStyle="#fff";cx.font="900 32px 'Arial Black',Arial,sans-serif";cx.textAlign="center";
  cx.fillText("ðŸ€ TABLONCILLO",540,70);
  cx.fillStyle=GD;cx.font="700 16px Arial,sans-serif";cx.fillText("LIGA DE LA HABANA",540,100);
  cx.fillStyle="#555";cx.font="600 14px Arial,sans-serif";cx.fillText(g.dt+(g.loc?" Â· "+g.loc:""),540,130);
  // Team badges (big circles)
  [{t:at,id:g.away,x:270,sc:g.as,w:!hw},{t:ht,id:g.home,x:810,sc:g.hs,w:hw}].forEach(({t,id,x,sc,w})=>{
    // Badge circle
    cx.beginPath();cx.arc(x,320,90,0,Math.PI*2);cx.fillStyle=t.c;cx.fill();
    cx.fillStyle=t.a;cx.font="900 52px 'Arial Black',Arial,sans-serif";cx.textAlign="center";cx.textBaseline="middle";
    cx.fillText(id,x,320);cx.textBaseline="alphabetic";
    // Team name
    cx.fillStyle=w?"#fff":"#888";cx.font=(w?"900":"600")+" 28px Arial,sans-serif";cx.fillText(t.name,x,450);
    cx.fillStyle="#555";cx.font="500 14px Arial,sans-serif";cx.fillText(t.zone,x,480);
    // Score
    cx.fillStyle=w?"#fff":"#555";cx.font="900 120px 'Arial Black',Arial,sans-serif";cx.fillText(String(sc),x,640);
    if(w){cx.fillStyle=GN;cx.font="700 18px Arial,sans-serif";cx.fillText("GANADOR",x,680)}});
  // VS
  cx.fillStyle=AC;cx.font="900 36px 'Arial Black',Arial,sans-serif";cx.textAlign="center";cx.fillText("â€”",540,620);
  cx.fillStyle="#333";cx.font="700 14px Arial,sans-serif";cx.fillText("FINAL",540,580);
  // Quarter scores
  const qs=g.qs||[[0,0],[0,0],[0,0],[0,0]];
  cx.fillStyle="#333";cx.font="600 13px Arial,sans-serif";
  qs.forEach((qr,i)=>{const qx=340+i*100;cx.fillStyle="#555";cx.fillText("Q"+(i+1),qx,730);cx.fillStyle="#888";cx.fillText(qr[0]+"-"+qr[1],qx,755)});
  // Divider
  cx.strokeStyle="#333";cx.lineWidth=1;cx.beginPath();cx.moveTo(100,790);cx.lineTo(980,790);cx.stroke();
  // Top performers
  cx.fillStyle=GD;cx.font="900 20px Arial,sans-serif";cx.textAlign="center";cx.fillText("DESTACADOS",540,830);
  [{p:topA,t:at,y:880},{p:topH,t:ht,y:1000}].forEach(({p,t,y})=>{if(!p)return;
    // Player bar background
    cx.fillStyle=t.c+"22";cx.beginPath();cx.roundRect(80,y-30,920,80,12);cx.fill();
    cx.strokeStyle=t.c+"44";cx.lineWidth=1;cx.beginPath();cx.roundRect(80,y-30,920,80,12);cx.stroke();
    // Mini badge
    cx.beginPath();cx.arc(140,y+10,24,0,Math.PI*2);cx.fillStyle=t.c;cx.fill();
    cx.fillStyle=t.a;cx.font="900 16px Arial,sans-serif";cx.textAlign="center";cx.textBaseline="middle";cx.fillText(t.id.slice(0,3),140,y+10);cx.textBaseline="alphabetic";
    // Name
    cx.fillStyle="#fff";cx.font="800 22px Arial,sans-serif";cx.textAlign="left";cx.fillText("#"+p.num+" "+p.nm,180,y+4);
    cx.fillStyle="#888";cx.font="500 13px Arial,sans-serif";cx.fillText(t.name,180,y+28);
    // Stats
    cx.textAlign="right";
    cx.fillStyle=AC;cx.font="900 32px 'Arial Black',Arial,sans-serif";cx.fillText(String(p.pts),920,y+8);
    cx.fillStyle="#888";cx.font="600 12px Arial,sans-serif";cx.fillText("PTS",920,y+28);
    cx.fillStyle="#C9A84C";cx.font="900 20px Arial,sans-serif";cx.fillText(String(p.reb),840,y+8);
    cx.fillStyle="#888";cx.font="600 10px Arial,sans-serif";cx.fillText("REB",840,y+28);
    cx.fillStyle="#5BB8A6";cx.font="900 20px Arial,sans-serif";cx.fillText(String(p.ast),770,y+8);
    cx.fillStyle="#888";cx.font="600 10px Arial,sans-serif";cx.fillText("AST",770,y+28)});
  // Description
  if(g.desc){cx.fillStyle="#888";cx.font="italic 500 16px Arial,sans-serif";cx.textAlign="center";cx.fillText(g.desc.slice(0,60),540,1150)}
  // Footer
  cx.fillStyle="#333";cx.font="700 14px Arial,sans-serif";cx.textAlign="center";cx.fillText("tabloncillo.github.io",540,1290);
  cx.fillStyle="#555";cx.font="500 12px Arial,sans-serif";cx.fillText("Baloncesto Cubano Â· Liga de La Habana",540,1315);
  return cvs;
}

// â”€â”€â”€ DARK WALLPAPER MODE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showWallpaper(g){
  S.wallpaper=g.id;render();
}
function rWallpaper(){
  const g=S.games.find(x=>x.id===S.wallpaper);if(!g)return h("div");
  const at=gt(g.away),ht=gt(g.home);const hw=g.hs>g.as;
  const topPlayers=(g.ps||[]).sort((a,b)=>b.pts-a.pts).slice(0,4);
  const el=h("div",{style:{position:"fixed",inset:"0",background:"#000",zIndex:"9999",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"20px"}});
  el.appendChild(h("button",{style:{position:"absolute",top:"12px",right:"12px",background:"#1A3352aa",border:"none",borderRadius:"8px",padding:"8px 14px",color:"#E8DFD0",fontSize:"11px",fontWeight:"700",cursor:"pointer",zIndex:"10000"},onClick:()=>{S.wallpaper=null;render()}},"âœ• CERRAR"));
  // Scoreboard card
  const card=h("div",{style:{background:"linear-gradient(135deg,#111,#0F1F35)",borderRadius:"24px",padding:"32px 40px",width:"min(500px,90vw)",textAlign:"center",position:"relative",overflow:"hidden"}});
  card.appendChild(h("div",{style:{position:"absolute",top:"0",left:"0",right:"0",height:"4px",background:`linear-gradient(90deg,${at.c},${AC},${ht.c})`}}));
  card.appendChild(h("div",{style:{fontSize:"12px",fontWeight:"900",letterSpacing:"4px",color:"#3A5068",marginBottom:"16px"}},"ðŸ€ TABLONCILLO"));
  card.appendChild(h("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"24px"}},
    h("div",{style:{textAlign:"center"}},bd(g.away,40),h("div",{style:{fontSize:"14px",fontWeight:"700",color:!hw?"#fff":"#888",marginTop:"6px"}},at.name),
      h("div",{style:{fontSize:"64px",fontWeight:"900",color:!hw?"#fff":"#444",lineHeight:"1"}},String(g.as))),
    h("div",{style:{textAlign:"center"}},h("div",{style:{fontSize:"12px",color:GN,fontWeight:"700"}},"FINAL"),h("div",{style:{fontSize:"28px",color:"#253A52",fontWeight:"900"}},"â€”")),
    h("div",{style:{textAlign:"center"}},bd(g.home,40),h("div",{style:{fontSize:"14px",fontWeight:"700",color:hw?"#fff":"#888",marginTop:"6px"}},ht.name),
      h("div",{style:{fontSize:"64px",fontWeight:"900",color:hw?"#fff":"#444",lineHeight:"1"}},String(g.hs)))));
  if(g.qs){card.appendChild(h("div",{style:{display:"flex",justifyContent:"center",gap:"16px",marginTop:"12px"}},
    ...g.qs.map((qr,i)=>h("div",{style:{textAlign:"center"}},h("span",{style:{fontSize:"9px",color:"#2E4560"}},"Q"+(i+1)),h("div",{style:{fontSize:"11px",color:"#4A6480"}},qr[0]+"-"+qr[1])))))}
  // Top players
  if(topPlayers.length){card.appendChild(h("div",{style:{borderTop:"1px solid #1A335260",marginTop:"16px",paddingTop:"12px"}},
    ...topPlayers.map(p=>{const pt=gt(p.tm);return h("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"4px 0"}},
      bd(p.tm,16),h("span",{style:{fontSize:"11px",color:"#B8C8D8",flex:"1",textAlign:"left"}},p.nm),
      h("span",{style:{fontSize:"14px",fontWeight:"900",color:AC}},String(p.pts)),
      h("span",{style:{fontSize:"9px",color:"#3A5068"}},"pts"))})))}
  card.appendChild(h("div",{style:{fontSize:"9px",color:"#253A52",marginTop:"12px"}},"tabloncillo.github.io Â· "+g.dt));
  el.appendChild(card);
  // Save as image button
  el.appendChild(h("div",{style:{display:"flex",gap:"8px",marginTop:"16px"}},
    h("button",{style:{background:AC,border:"none",borderRadius:"4px",padding:"12px 24px",color:"#E8DFD0",fontSize:"12px",fontWeight:"800",cursor:"pointer"},
      onClick:()=>{const cvs=genSocialCard(g);cvs.toBlob(blob=>{const url=URL.createObjectURL(blob);const a=document.createElement("a");a.href=url;a.download="tabloncillo-"+at.name+"-vs-"+ht.name+"-"+g.dt+".png";a.click()},"image/png")}},"ðŸ“¸ DESCARGAR IMAGEN"),
    h("button",{style:{background:"#25D366",border:"none",borderRadius:"4px",padding:"12px 24px",color:"#E8DFD0",fontSize:"12px",fontWeight:"800",cursor:"pointer"},
      onClick:()=>{const txt=`ðŸ€ TABLONCILLO\n${at.name} ${g.as} â€” ${g.hs} ${ht.name}\n${topPlayers.slice(0,2).map(p=>"â­ "+p.nm+" "+p.pts+"pts").join("\n")}\n${g.desc||""}\ntabloncillo.github.io`;
        try{navigator.share?.({text:txt})}catch{window.open("https://wa.me/?text="+encodeURIComponent(txt))}}},"ðŸ“¤ COMPARTIR")));
  el.appendChild(h("div",{style:{fontSize:"9px",color:"#3A5068",marginTop:"8px"}},"Haz screenshot para publicar en redes sociales"));
  return el;
}

// â”€â”€â”€ MVP TRACKER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rMVP(){
  const allP={};const teamRec={};
  T.forEach(t=>{teamRec[t.id]={w:0,l:0}});
  S.games.forEach(g=>{const hw=g.hs>g.as;if(teamRec[g.home]){teamRec[g.home][hw?"w":"l"]++;teamRec[g.away][hw?"l":"w"]++}
    g.ps?.forEach(p=>{const k=p.nm+"|||"+p.tm;if(!allP[k])allP[k]={nm:p.nm,tm:p.tm,num:p.num,gp:0,pts:0,reb:0,ast:0,stl:0,blk:0,wins:0};
      allP[k].gp++;allP[k].pts+=p.pts;allP[k].reb+=p.reb;allP[k].ast+=p.ast;allP[k].stl+=p.stl;allP[k].blk+=p.blk;
      const won=(g.home===p.tm&&g.hs>g.as)||(g.away===p.tm&&g.as>g.hs);if(won)allP[k].wins++})});
  const players=Object.values(allP).filter(p=>p.gp>=1).map(p=>{
    const ppg=p.pts/p.gp,rpg=p.reb/p.gp,apg=p.ast/p.gp,spg=p.stl/p.gp,bpg=p.blk/p.gp;
    const winPct=p.wins/p.gp;
    // MVP Score: weighted formula
    const mvp=ppg*1.0 + rpg*0.7 + apg*0.8 + spg*0.6 + bpg*0.5 + winPct*8;
    return{...p,ppg,rpg,apg,spg,bpg,winPct,mvp}}).sort((a,b)=>b.mvp-a.mvp);
  const el=h("div",{style:{display:"flex",flexDirection:"column",gap:"12px"}});
  el.appendChild(h("div",{style:{fontSize:"16px",fontWeight:"900",letterSpacing:"2px"}},"ðŸ… MVP TRACKER"));
  el.appendChild(h("div",{style:{fontSize:"10px",color:"#5A7A96"}},"PTSÃ—1.0 + REBÃ—0.7 + ASTÃ—0.8 + ROBÃ—0.6 + BLQÃ—0.5 + VictoriasÃ—8"));
  if(!players.length)return h("div",{style:{textAlign:"center",padding:"40px",color:"#3A5068"}},"Se necesitan juegos con stats");
  // Top 3 podium
  const top3=players.slice(0,3);
  const podium=h("div",{style:{display:"flex",justifyContent:"center",alignItems:"flex-end",gap:"8px",padding:"12px 0"}});
  [{p:top3[1],rank:2,ht:"140px",medal:"ðŸ¥ˆ"},{p:top3[0],rank:1,ht:"180px",medal:"ðŸ¥‡"},{p:top3[2],rank:3,ht:"110px",medal:"ðŸ¥‰"}].forEach(({p,rank,ht:h2,medal})=>{
    if(!p)return;const t=gt(p.tm);
    podium.appendChild(h("div",{style:{textAlign:"center",width:"100px"}},
      h("div",{style:{fontSize:"28px",marginBottom:"4px"}},medal),
      bd(p.tm,28),
      h("div",{style:{fontSize:"11px",fontWeight:"800",color:"#E8DFD0",marginTop:"4px"}},p.nm),
      h("div",{style:{fontSize:"9px",color:"#5A7A96"}},t.name),
      h("div",{style:{height:h2,background:`linear-gradient(180deg,${rank===1?GD:rank===2?"#C0C0C0":"#CD7F32"}44,transparent)`,borderRadius:"8px 8px 0 0",marginTop:"6px",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"}},
        h("div",{style:{fontSize:"20px",fontWeight:"900",color:rank===1?GD:"#fff"}},p.mvp.toFixed(1)),
        h("div",{style:{fontSize:"8px",color:"#5A7A96"}},"MVP SCORE"))))});
  el.appendChild(podium);
  // Full list
  players.slice(0,15).forEach((p,i)=>{const t=gt(p.tm);
    el.appendChild(h("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",background:i<3?`${[GD,"#C0C0C0","#CD7F32"][i]}08`:"#0F1F35",border:"1px solid "+(i<3?`${[GD,"#C0C0C0","#CD7F32"][i]}22`:"#1A335240"),borderRadius:"4px",marginBottom:"3px",cursor:"pointer"},onClick:()=>{S.pp=p.nm+"|||"+p.tm;S.tab="player";render()}},
      h("span",{style:{fontSize:"14px",fontWeight:"900",color:i<3?[GD,"#C0C0C0","#CD7F32"][i]:"#555",width:"20px"}},String(i+1)),
      bd(p.tm,20),
      h("div",{style:{flex:"1"}},h("div",{style:{fontSize:"12px",fontWeight:"700",color:i<3?"#fff":"#ccc"}},p.nm),
        h("div",{style:{fontSize:"9px",color:"#3A5068"}},t.name+" Â· "+p.gp+"J Â· "+(p.winPct*100).toFixed(0)+"% W")),
      h("div",{style:{textAlign:"right"}},
        h("div",{style:{display:"flex",gap:"8px",alignItems:"baseline"}},
          h("span",{style:{fontSize:"9px",color:AC}},p.ppg.toFixed(1)+"p"),
          h("span",{style:{fontSize:"9px",color:"#C9A84C"}},p.rpg.toFixed(1)+"r"),
          h("span",{style:{fontSize:"9px",color:"#5BB8A6"}},p.apg.toFixed(1)+"a")),
        h("div",{style:{fontSize:"16px",fontWeight:"900",color:i<3?GD:AC}},p.mvp.toFixed(1)))))});
  return el;
}

// â”€â”€â”€ SEASON ARCHIVE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function rSeasonArchive(){
  const el=h("div",{style:{display:"flex",flexDirection:"column",gap:"12px"}});
  el.appendChild(h("div",{style:{fontSize:"16px",fontWeight:"900",letterSpacing:"2px"}},"ðŸ“¦ ARCHIVO DE TEMPORADAS"));
  // Current season summary
  const rec={};T.forEach(t=>{rec[t.id]={w:0,l:0}});S.games.forEach(g=>{const hw=g.hs>g.as;if(rec[g.home]){rec[g.home][hw?"w":"l"]++;rec[g.away][hw?"l":"w"]++}});
  const leader=T.map(t=>({...t,...rec[t.id]})).sort((a,b)=>b.w-a.w)[0];
  el.appendChild(h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",padding:"14px 16px"}},
    h("div",{style:{fontSize:"11px",fontWeight:"800",color:GN,letterSpacing:"1px",marginBottom:"6px"}},"TEMPORADA ACTUAL"),
    h("div",{style:{fontSize:"10px",color:"#5A7A96"}},S.games.length+" juegos Â· "+S.sched.length+" programados"),
    leader.w?h("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginTop:"8px"}},bd(leader.id,20),h("span",{style:{fontSize:"11px",color:"#B8C8D8"}},leader.name+" lidera "+leader.w+"-"+leader.l)):null));
  if(S.admin){el.appendChild(h("button",{style:{background:"linear-gradient(135deg,#CE1126,#ff6b35)",border:"none",borderRadius:"4px",padding:"14px",color:"#E8DFD0",fontSize:"13px",fontWeight:"800",cursor:"pointer",letterSpacing:"1px"},
    onClick:()=>{if(!confirm("Â¿Archivar temporada actual? Se guardarÃ¡n todos los juegos y se empezarÃ¡ de cero."))return;
      const seasonId="season_"+new Date().getFullYear()+"_"+Date.now();
      const archive={id:seasonId,games:S.games,schedule:S.sched,playoffs:DB.get("playoffs"),date:new Date().toISOString(),totalGames:S.games.length};
      DB.set(seasonId,archive);
      // Clear current games
      S.games.forEach(g=>DB.del(g.id));S.sched.forEach(s=>DB.del(s.id));DB.del("playoffs");
      S.games=[];S.sched=[];alert("âœ… Temporada archivada con "+archive.totalGames+" juegos");render()}},"ðŸ“¦ ARCHIVAR TEMPORADA ACTUAL"))}
  // Past seasons
  const seasons=DB.all("season_").sort((a,b)=>new Date(b.date)-new Date(a.date));
  if(seasons.length){el.appendChild(h("div",{style:{fontSize:"12px",fontWeight:"800",letterSpacing:"1px",marginTop:"8px"}},"TEMPORADAS ANTERIORES"));
    seasons.forEach(s=>{el.appendChild(h("div",{style:{background:"#0F1F35",border:"1px solid #1A335260",borderRadius:"4px",padding:"14px 16px",marginBottom:"4px"}},
      h("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},
        h("div",null,h("div",{style:{fontSize:"13px",fontWeight:"800",color:"#E8DFD0"}},new Date(s.date).toLocaleDateString("es",{year:"numeric",month:"long"})),
          h("div",{style:{fontSize:"10px",color:"#5A7A96"}},s.totalGames+" juegos")),
        h("div",{style:{display:"flex",gap:"6px"}},
          h("button",{style:{background:"#1A335240",border:"1px solid #1A335280",borderRadius:"8px",padding:"6px 10px",color:"#8BA0B4",fontSize:"9px",fontWeight:"700",cursor:"pointer"},
            onClick:()=>{if(!confirm("Â¿Restaurar esta temporada? ReemplazarÃ¡ los datos actuales."))return;
              S.games.forEach(g2=>DB.del(g2.id));S.sched.forEach(sc=>DB.del(sc.id));
              s.games.forEach(g2=>DB.set(g2.id,g2));(s.schedule||[]).forEach(sc=>DB.set(sc.id,sc));
              if(s.playoffs)DB.set("playoffs",s.playoffs);
              S.games=s.games.sort((a,b)=>(b.createdAt||0)-(a.createdAt||0));S.sched=s.schedule||[];
              alert("âœ… Temporada restaurada");render()}},"â™»ï¸ RESTAURAR"),
          S.admin?h("button",{style:{background:"rgba(255,59,48,.1)",border:"1px solid rgba(255,59,48,.3)",borderRadius:"8px",padding:"6px 10px",color:"#CE1126",fontSize:"9px",fontWeight:"700",cursor:"pointer"},
            onClick:()=>{if(!confirm("Â¿Eliminar archivo permanentemente?"))return;DB.del(s.id);render()}},"ðŸ—‘ï¸"):null))))})}
  return el;
}

// â”€â”€â”€ RENDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function render(){
  const app=document.getElementById("app");app.innerHTML="";
  if(S.wallpaper){app.appendChild(rWallpaper());return}
  if(S.view==="hero"){app.appendChild(rHero());return}
  if(S.court){app.appendChild(h("div",{style:{padding:"10px 16px",maxWidth:"800px",margin:"0 auto"}},
    h("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"}},
      h("button",{style:{background:"none",border:"none",color:"#5A7A96",fontSize:"11px",fontWeight:"700",cursor:"pointer"},onClick:()=>{if(!S.court.live||confirm("Â¿Salir sin guardar?")){if(S.court?.shotInterval)clearInterval(S.court.shotInterval);if(S.court?.gameInterval)clearInterval(S.court.gameInterval);S.court=null;S.tab="admin";render()}}},"â† SALIR"),
      h("div",{style:{fontSize:"13px",fontWeight:"900",letterSpacing:"3px"}},"ðŸ€ CANCHA"))));
    app.appendChild(h("div",{style:{padding:"0 16px",maxWidth:"800px",margin:"0 auto"}},rCourt()));return}
  // Header â€” industrial Cuban style
  const hdr=h("div",{style:{padding:"10px 16px 0",maxWidth:"800px",margin:"0 auto"}});
  const hdrBar=h("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",paddingBottom:"8px",borderBottom:"2px solid "+BD}});
  hdrBar.appendChild(h("div",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},onClick:()=>{S.tab="scores";S.tp=null;render()}},
    h("img",{src:LOGO_SM,style:{width:"24px",height:"24px",filter:"invert(.92) brightness(1.1) sepia(.08)"}}),
    h("div",{style:{fontSize:"15px",fontWeight:"700",letterSpacing:"3px",fontFamily:"'Oswald',sans-serif",textTransform:"uppercase",color:"#E8DFD0"}},"TABLONCILLO")));
  hdrBar.appendChild(h("div",{style:{display:"flex",gap:"4px",alignItems:"center"}},
    h("button",{style:{background:"none",border:"1px solid "+BD,borderRadius:"2px",padding:"4px 6px",cursor:"pointer",color:"#3A5068",fontSize:"8px"},onClick:()=>{S.view="hero";render()}},"ðŸ "),
    h("button",{style:{background:S.tab==="profile"?GD+"22":"transparent",border:"1px solid "+(S.tab==="profile"?GD+"44":BD),borderRadius:"2px",padding:"4px 8px",cursor:"pointer",color:S.tab==="profile"?GD:"#5A7A96",fontSize:"8px",fontWeight:"700"},onClick:()=>{S.tab="profile";render()}},"ðŸ”® PREDICCIONES"),
    S.admin||S.reporter?h("button",{style:{background:AC,border:"none",borderRadius:"2px",padding:"4px 8px",cursor:"pointer",color:"#E8DFD0",fontSize:"8px",fontWeight:"700"},onClick:()=>{S.court={live:false};render()}},"ðŸ€ CANCHA"):null,
    !S.admin&&!S.reporter?h("button",{style:{background:"transparent",border:"1px solid "+BD,borderRadius:"2px",padding:"4px 8px",cursor:"pointer",color:"#3A5068",fontSize:"8px"},onClick:()=>{const p=prompt("PIN:");if(p===ADMIN_PIN){S.admin=true;S.reporter=true;S.tab="admin";render()}else if(p===REP_PIN){S.reporter=true;S.tab="scores";render()}else if(p)alert("PIN incorrecto")}},"ðŸ”‘"):
    S.admin?h("div",{style:{padding:"3px 6px",background:AC+"22",borderRadius:"2px",border:"1px solid "+AC+"44"}},h("span",{style:{fontSize:"7px",fontWeight:"700",color:AC,fontFamily:"'Oswald',sans-serif"}},"ADMIN")):
    h("div",{style:{padding:"3px 6px",background:GN+"22",borderRadius:"2px",border:"1px solid "+GN+"44"}},h("span",{style:{fontSize:"7px",fontWeight:"700",color:GN,fontFamily:"'Oswald',sans-serif"}},"REPORTER"))));
  hdr.appendChild(hdrBar);app.appendChild(hdr);
  // Content
  const content=h("div",{style:{padding:"0 16px 90px",maxWidth:"800px",margin:"0 auto"}});
  if(S.tab==="scores")content.appendChild(rScores());
  else if(S.tab==="standings")content.appendChild(rStand());
  else if(S.tab==="leaders")content.appendChild(rLeaders());
  else if(S.tab==="calendar")content.appendChild(rCalendar());
  else if(S.tab==="profile")content.appendChild(rProfile());
  else if(S.tab==="playoffs")content.appendChild(rPlayoffs());
  else if(S.tab==="allstar")content.appendChild(rAllStar());
  else if(S.tab==="mvp")content.appendChild(rMVP());
  else if(S.tab==="archive")content.appendChild(rSeasonArchive());
  else if(S.tab==="player"&&S.pp)content.appendChild(rPlayer());
  else if(S.tab==="team"&&S.tp)content.appendChild(rTeam());
  else if(S.tab==="admin"&&(S.admin||S.reporter))content.appendChild(rAdmin());
  app.appendChild(content);
  // Nav â€” sharp edges, Cuban industrial
  const isLive=!!S.court;
  const tabs=[{k:"scores",ic:isLive?"live":"juegos",l:isLive?"EN VIVO":"JUEGOS",cls:isLive?"pulse":""},
    {k:"standings",ic:"tabla",l:"TABLA"},{k:"mvp",ic:"mvp",l:"MVP"},{k:"playoffs",ic:"playoffs",l:"PLAYOFFS"},
    {k:"calendar",ic:"cal",l:"CALENDARIO"}];
  if(S.admin||S.reporter)tabs.push({k:"admin",ic:"admin",l:S.admin?"ADMIN":"REPORTAR"});
  app.appendChild(h("div",{style:{position:"fixed",bottom:"0",left:"0",right:"0",background:`linear-gradient(180deg,transparent,${BG} 30%)`,paddingTop:"20px"}},
    h("div",{style:{display:"flex",maxWidth:"800px",margin:"0 auto",padding:"0 4px 10px",borderTop:"1px solid "+BD}},
      ...tabs.map(tb=>h("button",{style:{flex:"1",display:"flex",flexDirection:"column",alignItems:"center",gap:"2px",padding:"8px 0",background:"none",border:"none",cursor:"pointer"},onClick:()=>{S.tab=tb.k;S.tp=null;S.pp=null;render()}},
        tb.ic==="live"?h("div",{className:"pulse",innerHTML:IC.live,style:{display:"flex",alignItems:"center",justifyContent:"center",width:"20px",height:"20px"}}):navIcon(tb.ic,S.tab===tb.k),
        h("span",{style:{fontSize:"7px",fontWeight:"700",letterSpacing:"1px",color:S.tab===tb.k?"#E8DFD0":"#2E4560",fontFamily:"'Oswald',sans-serif"}},tb.l),
        S.tab===tb.k?h("div",{style:{width:"16px",height:"2px",background:AC,marginTop:"2px"}}):null)))));
}
init();
// â”€â”€â”€ PWA SERVICE WORKER + INSTALL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let deferredPrompt=null;
window.addEventListener("beforeinstallprompt",e=>{e.preventDefault();deferredPrompt=e;showInstallBanner()});
function showInstallBanner(){
  if(document.getElementById("pwa-banner"))return;
  const banner=h("div",{id:"pwa-banner",style:{position:"fixed",bottom:"70px",left:"16px",right:"16px",maxWidth:"768px",margin:"0 auto",background:SF,border:"2px solid "+AC,borderRadius:"4px",padding:"14px",display:"flex",alignItems:"center",gap:"12px",zIndex:"999",boxShadow:"0 8px 32px rgba(0,0,0,.5)"}},
    h("img",{src:LOGO_SM,style:{width:"24px",height:"24px",filter:"invert(.92) brightness(1.1)"}}),
    h("div",{style:{flex:"1"}},
      h("div",{style:{fontSize:"13px",fontWeight:"700",color:"#E8DFD0",fontFamily:"'Oswald',sans-serif",letterSpacing:"1px"}},"INSTALAR TABLONCILLO"),
      h("div",{style:{fontSize:"10px",color:"#5A7A96"}},"Accede desde tu pantalla de inicio")),
    h("button",{style:{background:AC,border:"none",borderRadius:"2px",padding:"8px 16px",color:"#E8DFD0",fontSize:"11px",fontWeight:"700",cursor:"pointer",fontFamily:"'Oswald',sans-serif",letterSpacing:"1px"},
      onClick:()=>{if(deferredPrompt){deferredPrompt.prompt();deferredPrompt.userChoice.then(()=>{deferredPrompt=null;banner.remove()})}}},"INSTALAR"),
    h("button",{style:{background:"none",border:"none",color:"#3A5068",fontSize:"16px",cursor:"pointer",padding:"0 4px"},onClick:()=>banner.remove()},"âœ•"));
  document.body.appendChild(banner)}
// Register service worker
if("serviceWorker"in navigator){
  const swCode=`
    const CACHE="tabloncillo-v22";
    const URLS=[self.location.href];
    self.addEventListener("install",e=>e.waitUntil(caches.open(CACHE).then(c=>c.addAll(URLS)).then(()=>self.skipWaiting())));
    self.addEventListener("activate",e=>e.waitUntil(caches.keys().then(ks=>Promise.all(ks.filter(k=>k!==CACHE).map(k=>caches.delete(k)))).then(()=>self.clients.claim())));
    self.addEventListener("fetch",e=>{e.respondWith(caches.match(e.request).then(r=>r||fetch(e.request).then(res=>{if(res.ok){const cl=res.clone();caches.open(CACHE).then(c=>c.put(e.request,cl))}return res}).catch(()=>caches.match(self.location.href))))}); `;
  const blob=new Blob([swCode],{type:"application/javascript"});
  navigator.serviceWorker.register(URL.createObjectURL(blob)).catch(()=>{})}
// iOS install hint
if(navigator.standalone===false||window.matchMedia("(display-mode:browser)").matches){
  const isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent);
  if(isIOS&&!localStorage.getItem("ios_hint_shown")){
    setTimeout(()=>{
      const hint=h("div",{id:"ios-hint",style:{position:"fixed",bottom:"70px",left:"16px",right:"16px",maxWidth:"768px",margin:"0 auto",background:SF,border:"2px solid "+GD,borderRadius:"4px",padding:"14px",display:"flex",alignItems:"center",gap:"12px",zIndex:"999",boxShadow:"0 8px 32px rgba(0,0,0,.5)"}},
        h("img",{src:LOGO_SM,style:{width:"24px",height:"24px",filter:"invert(.92) brightness(1.1) sepia(.3)"}}),
        h("div",{style:{flex:"1"}},
          h("div",{style:{fontSize:"13px",fontWeight:"700",color:"#E8DFD0",fontFamily:"'Oswald',sans-serif",letterSpacing:"1px"}},"AÃ‘ADIR A INICIO"),
          h("div",{style:{fontSize:"10px",color:"#5A7A96"}},"Toca el botÃ³n Compartir â¬† y luego \"AÃ±adir a pantalla de inicio\"")),
        h("button",{style:{background:"none",border:"none",color:"#3A5068",fontSize:"16px",cursor:"pointer",padding:"0 4px"},onClick:()=>{hint.remove();localStorage.setItem("ios_hint_shown","1")}},"âœ•"));
      document.body.appendChild(hint)},3000)}}
</script>
</body>
</html>
